{"id":"deco-03s","title":"Define DecoError structure","description":"Create internal/domain/error.go with DecoError struct: Code, Summary, Detail, Location, Context, Suggestion, Related. Include Location and Related types.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:03.2628684+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.3747521+01:00","closed_at":"2026-01-31T14:27:10.40304+01:00","dependencies":[{"issue_id":"deco-03s","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:19:23.4771253+01:00","created_by":"Toernblom"},{"issue_id":"deco-03s","depends_on_id":"deco-16w","type":"blocks","created_at":"2026-01-30T15:26:45.6011273+01:00","created_by":"Toernblom"}]}
{"id":"deco-04f","title":"Validation performance on large projects","description":"Goal: validation scales to large graphs.\n\nAcceptance:\n- Benchmark suite added.\n- Identify/resolve hot spots.","status":"open","priority":3,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T18:13:34.5695399+01:00","created_by":"Toernblom","updated_at":"2026-02-01T18:13:34.5695399+01:00","dependencies":[{"issue_id":"deco-04f","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:13:34.8978877+01:00","created_by":"Toernblom"}]}
{"id":"deco-0hm","title":"Write tests for Issue domain type","description":"TDD: Write failing tests for Issue struct. Test: creation, severity levels, location tracking, resolved state.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:15.5618012+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.3774244+01:00","closed_at":"2026-01-31T14:16:10.3487616+01:00"}
{"id":"deco-0ja","title":"deco set cannot update non-string fields","description":"Repro:\n1) Run: deco set systems/core version 2 \u003cdir\u003e\n\nActual: Error \"cannot convert string to int\".\nExpected: CLI should parse numeric/boolean/JSON values based on target field type (or allow a --json flag) so common fields like version can be updated.\nRefs: internal/cli/set.go, internal/services/patcher/patcher.go.","status":"closed","priority":2,"issue_type":"bug","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T17:30:26.4103338+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:59:27.7643679+01:00","closed_at":"2026-02-01T17:59:27.7643679+01:00","close_reason":"Fix verified: parseValue() in set.go parses CLI values to appropriate types (int, float, bool, JSON) before passing to patcher. End-to-end test confirmed 'deco set systems/core version 2' works correctly.","dependencies":[{"issue_id":"deco-0ja","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:08:10.5523815+01:00","created_by":"Toernblom"}]}
{"id":"deco-0jp","title":"Write tests for deco set command","description":"TDD: Write failing tests for set command. Test: sets field value, validates after set, creates history entry, error on invalid path.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:26:09.665878+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.3795517+01:00","closed_at":"2026-01-31T15:53:06.5453894+01:00","dependencies":[{"issue_id":"deco-0jp","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:28:43.8167866+01:00","created_by":"Toernblom"},{"issue_id":"deco-0jp","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:28:45.2539026+01:00","created_by":"Toernblom"}]}
{"id":"deco-0kr","title":"Implement deco apply command","description":"Create internal/cli/apply.go. Apply patch file for AI integration.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:55.7683266+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.3811461+01:00","closed_at":"2026-01-31T15:58:32.8049296+01:00","dependencies":[{"issue_id":"deco-0kr","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:19:24.9205431+01:00","created_by":"Toernblom"},{"issue_id":"deco-0kr","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:19:28.6246623+01:00","created_by":"Toernblom"},{"issue_id":"deco-0kr","depends_on_id":"deco-tzg","type":"blocks","created_at":"2026-01-30T15:27:18.0501522+01:00","created_by":"Toernblom"}]}
{"id":"deco-0o3","title":"Implement GraphBuilder service","description":"Create internal/service/graph/builder.go. Build Graph from slice of Nodes, populate reverse reference index.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:14:47.8947462+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.3827585+01:00","closed_at":"2026-01-31T15:00:08.0762739+01:00","dependencies":[{"issue_id":"deco-0o3","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:19:16.6683549+01:00","created_by":"Toernblom"},{"issue_id":"deco-0o3","depends_on_id":"deco-jxy","type":"blocks","created_at":"2026-01-30T15:26:46.4135279+01:00","created_by":"Toernblom"}]}
{"id":"deco-0ql","title":"Add deco export command for multiple output formats","description":"Add a 'deco export' command supporting multiple output formats: --format=html, --format=markdown, --format=pdf. Complements the LaTeX feature. Should produce navigable documentation with cross-references.","status":"closed","priority":3,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T16:32:10.9741341+01:00","created_by":"Anton","updated_at":"2026-01-31T16:32:55.7673329+01:00","closed_at":"2026-01-31T16:32:55.7673329+01:00","close_reason":"LaTeX is sufficient - it generates PDF anyway. Clients can convert to other formats if needed."}
{"id":"deco-0s1","title":"Implement QueryEngine filter","description":"Create internal/service/query/engine.go. Filter nodes by kind, status, tags, or custom predicates.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:41.6983291+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.3848935+01:00","closed_at":"2026-01-31T15:11:29.8739807+01:00","dependencies":[{"issue_id":"deco-0s1","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:19:18.7324176+01:00","created_by":"Toernblom"},{"issue_id":"deco-0s1","depends_on_id":"deco-3jm","type":"blocks","created_at":"2026-01-30T15:27:12.5040562+01:00","created_by":"Toernblom"}]}
{"id":"deco-0sk","title":"Add contract syntax validator","description":"Create internal/service/validator/contract.go. Validate contract scenarios syntax: given/when/then structure, field types, scenario IDs are unique within node.","status":"open","priority":4,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T14:01:53.9550117+01:00","created_by":"Anton","updated_at":"2026-01-31T14:01:53.9550117+01:00","dependencies":[{"issue_id":"deco-0sk","depends_on_id":"deco-4ci","type":"blocks","created_at":"2026-01-31T14:02:09.7928452+01:00","created_by":"Anton"}]}
{"id":"deco-142","title":"Implement node rename with ref updates","description":"Create internal/service/refactor/rename.go. Rename node ID and update all references across the graph.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:56.8861579+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.3864791+01:00","closed_at":"2026-01-31T16:06:59.2144404+01:00","dependencies":[{"issue_id":"deco-142","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:19:19.1436774+01:00","created_by":"Toernblom"},{"issue_id":"deco-142","depends_on_id":"deco-bhb","type":"blocks","created_at":"2026-01-30T15:27:15.7802303+01:00","created_by":"Toernblom"}]}
{"id":"deco-16e","title":"Foundation: Project setup and domain types","status":"closed","priority":1,"issue_type":"epic","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:14:05.6647459+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.3886027+01:00","closed_at":"2026-01-31T14:21:02.0223711+01:00","dependencies":[{"issue_id":"deco-16e","depends_on_id":"deco-rba","type":"blocks","created_at":"2026-01-30T15:18:32.3549532+01:00","created_by":"Toernblom"},{"issue_id":"deco-16e","depends_on_id":"deco-bqg","type":"blocks","created_at":"2026-01-30T15:18:32.6191699+01:00","created_by":"Toernblom"},{"issue_id":"deco-16e","depends_on_id":"deco-zty","type":"blocks","created_at":"2026-01-30T15:18:32.8365093+01:00","created_by":"Toernblom"},{"issue_id":"deco-16e","depends_on_id":"deco-982","type":"blocks","created_at":"2026-01-30T15:18:33.0501122+01:00","created_by":"Toernblom"},{"issue_id":"deco-16e","depends_on_id":"deco-lwx","type":"blocks","created_at":"2026-01-30T15:18:33.2625851+01:00","created_by":"Toernblom"},{"issue_id":"deco-16e","depends_on_id":"deco-rrk","type":"blocks","created_at":"2026-01-30T15:18:33.4894852+01:00","created_by":"Toernblom"},{"issue_id":"deco-16e","depends_on_id":"deco-8ca","type":"blocks","created_at":"2026-01-30T15:18:33.7656803+01:00","created_by":"Toernblom"},{"issue_id":"deco-16e","depends_on_id":"deco-p54","type":"blocks","created_at":"2026-01-30T15:18:34.0203849+01:00","created_by":"Toernblom"},{"issue_id":"deco-16e","depends_on_id":"deco-5ns","type":"blocks","created_at":"2026-01-30T15:18:34.2428644+01:00","created_by":"Toernblom"},{"issue_id":"deco-16e","depends_on_id":"deco-gpu","type":"blocks","created_at":"2026-01-30T15:18:34.4669036+01:00","created_by":"Toernblom"}]}
{"id":"deco-16w","title":"Write tests for DecoError structure","description":"TDD: Write failing tests for DecoError struct. Test: all fields populated, Location type, Related type, Error() method output.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:49.6853879+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.3902235+01:00","closed_at":"2026-01-31T14:22:15.5905018+01:00","dependencies":[{"issue_id":"deco-16w","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:29:01.3409727+01:00","created_by":"Toernblom"}]}
{"id":"deco-1eg","title":"Implement deco query command","description":"Create internal/cli/query.go. Search nodes with filter expressions, output matching nodes.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:19.5461004+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.3918508+01:00","closed_at":"2026-01-31T15:51:59.1483225+01:00","dependencies":[{"issue_id":"deco-1eg","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:19:23.6882644+01:00","created_by":"Toernblom"},{"issue_id":"deco-1eg","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:19:27.4588488+01:00","created_by":"Toernblom"},{"issue_id":"deco-1eg","depends_on_id":"deco-vz6","type":"blocks","created_at":"2026-01-30T15:27:07.854897+01:00","created_by":"Toernblom"}]}
{"id":"deco-1er","title":"Write tests for AuditEntry domain type","description":"TDD: Write failing tests for AuditEntry struct. Test: timestamp handling, operation types, before/after state capture.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:21.498645+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.3934687+01:00","closed_at":"2026-01-31T14:18:27.3379164+01:00"}
{"id":"deco-1fm","title":"Implement deco validate command","description":"Create internal/cli/validate.go. Load all nodes, build graph, run validation, output errors in Rust-like format.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:04.1675111+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.3950706+01:00","closed_at":"2026-01-31T15:38:51.3716061+01:00","dependencies":[{"issue_id":"deco-1fm","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:19:23.0306915+01:00","created_by":"Toernblom"},{"issue_id":"deco-1fm","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:19:26.8897367+01:00","created_by":"Toernblom"},{"issue_id":"deco-1fm","depends_on_id":"deco-sbk","type":"blocks","created_at":"2026-01-30T15:26:58.3159146+01:00","created_by":"Toernblom"}]}
{"id":"deco-1jc","title":"Write tests for YAML line number tracking","description":"TDD: Write failing tests for line/column tracking during YAML parsing. Test: accurate line numbers, column positions, nested structures, multiline values.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:26.2663362+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.3961398+01:00","closed_at":"2026-01-31T14:45:54.6084917+01:00","dependencies":[{"issue_id":"deco-1jc","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:28:00.7627169+01:00","created_by":"Toernblom"}]}
{"id":"deco-1pi","title":"Add deco stats command for project overview","description":"Add a 'deco stats' command showing project health: node count by kind, node count by status, open issues count by severity, reference health (dangling refs), constraint violations summary.","status":"open","priority":3,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T16:32:14.1922989+01:00","created_by":"Anton","updated_at":"2026-01-31T16:32:14.1922989+01:00"}
{"id":"deco-1v8","title":"Implement deco append command","description":"Create internal/cli/append.go. Append to array field: deco append \u003cid\u003e \u003cpath\u003e \u003cvalue\u003e.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:32.1695995+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.3969555+01:00","closed_at":"2026-01-31T15:55:24.2819275+01:00","dependencies":[{"issue_id":"deco-1v8","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:19:24.0946659+01:00","created_by":"Toernblom"},{"issue_id":"deco-1v8","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:19:27.8363386+01:00","created_by":"Toernblom"},{"issue_id":"deco-1v8","depends_on_id":"deco-zix","type":"blocks","created_at":"2026-01-30T15:27:11.6828454+01:00","created_by":"Toernblom"}]}
{"id":"deco-23m","title":"Saved queries / query presets","description":"Goal: let teams store common queries (e.g., open issues, orphan nodes).\n\nAcceptance:\n- Persist named queries in config.\n- `deco query --saved \u003cname\u003e` executes preset.\n- List/manage saved queries.","status":"open","priority":3,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T18:13:12.8714822+01:00","created_by":"Toernblom","updated_at":"2026-02-01T18:13:12.8714822+01:00","dependencies":[{"issue_id":"deco-23m","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:13:13.207674+01:00","created_by":"Toernblom"}]}
{"id":"deco-2t4","title":"Write tests for schema Validator","description":"TDD: Write failing tests for schema validation. Test: required fields (id, kind, version, status, title), missing fields, invalid types.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:40.7395243+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.3995388+01:00","closed_at":"2026-01-31T15:15:40.6252929+01:00","dependencies":[{"issue_id":"deco-2t4","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:28:05.1131248+01:00","created_by":"Toernblom"}]}
{"id":"deco-2y3","title":"Implement Validator orchestrator","description":"Create internal/service/validator/validator.go. Combine schema, refs, constraint validation. Return collected DecoErrors.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:13.2257405+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4009552+01:00","closed_at":"2026-01-31T15:18:53.1690222+01:00","dependencies":[{"issue_id":"deco-2y3","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:19:17.709435+01:00","created_by":"Toernblom"},{"issue_id":"deco-2y3","depends_on_id":"deco-az1","type":"blocks","created_at":"2026-01-30T15:27:02.9314052+01:00","created_by":"Toernblom"}]}
{"id":"deco-31k","title":"Implement deco unset command","description":"Create internal/cli/unset.go. Remove field: deco unset \u003cid\u003e \u003cpath\u003e.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:37.578104+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4019746+01:00","closed_at":"2026-01-31T15:56:54.0182326+01:00","dependencies":[{"issue_id":"deco-31k","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:19:24.2989958+01:00","created_by":"Toernblom"},{"issue_id":"deco-31k","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:19:28.0345545+01:00","created_by":"Toernblom"},{"issue_id":"deco-31k","depends_on_id":"deco-3vb","type":"blocks","created_at":"2026-01-30T15:27:13.341498+01:00","created_by":"Toernblom"}]}
{"id":"deco-336","title":"Write tests for Cobra root command","description":"TDD: Write failing tests for CLI root setup. Test: version flag, help output, global flags, subcommand registration.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:46.4027976+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4039895+01:00","closed_at":"2026-01-31T15:29:53.4815866+01:00","dependencies":[{"issue_id":"deco-336","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:28:26.3410462+01:00","created_by":"Toernblom"},{"issue_id":"deco-336","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:28:27.7841706+01:00","created_by":"Toernblom"}]}
{"id":"deco-344","title":"Write tests for file discovery","description":"TDD: Write failing tests for node file discovery. Test: walking directory tree, .yaml file detection, path-to-ID mapping, ignoring non-yaml files, empty directories.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:20.5505462+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4051016+01:00","closed_at":"2026-01-31T14:34:46.8270318+01:00","dependencies":[{"issue_id":"deco-344","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:27:56.4092928+01:00","created_by":"Toernblom"}]}
{"id":"deco-3co","title":"Write tests for Patcher append operation","description":"TDD: Write failing tests for append operation. Test: append to array, append to empty array, append to non-array error.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:55.4467485+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4071386+01:00","closed_at":"2026-01-31T15:04:15.286234+01:00","dependencies":[{"issue_id":"deco-3co","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:28:12.3233861+01:00","created_by":"Toernblom"}]}
{"id":"deco-3dy","title":"Set up CI/CD pipeline","description":"Set up GitHub Actions CI/CD pipeline for deco. Should include: run tests on PR/push, build binaries for multiple platforms (Linux, macOS, Windows), create releases with binaries on tag, run deco validate on example projects.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T16:32:16.5366874+01:00","created_by":"Anton","updated_at":"2026-01-31T16:53:38.3611087+01:00","closed_at":"2026-01-31T16:53:38.3611087+01:00","close_reason":"Closed"}
{"id":"deco-3ip","title":"Implement suggestion engine","description":"Create internal/errors/suggest.go. Generate 'did you mean?' suggestions using Levenshtein distance for typos in refs, kinds, status values.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:24.792438+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4081956+01:00","closed_at":"2026-01-31T14:52:30.8947133+01:00","dependencies":[{"issue_id":"deco-3ip","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:19:24.2833759+01:00","created_by":"Toernblom"},{"issue_id":"deco-3ip","depends_on_id":"deco-4dj","type":"blocks","created_at":"2026-01-30T15:26:56.4259267+01:00","created_by":"Toernblom"}]}
{"id":"deco-3ix","title":"Docs alignment: README/SPEC match schema \u0026 CLI behavior","description":"Goal: docs reflect reality and are consistent with tests.\n\nAcceptance:\n- README/SPEC examples validate.\n- CLI flags/behavior documented accurately.","status":"open","priority":3,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T18:13:17.1726518+01:00","created_by":"Toernblom","updated_at":"2026-02-01T18:13:17.1726518+01:00","dependencies":[{"issue_id":"deco-3ix","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:13:17.4979837+01:00","created_by":"Toernblom"}]}
{"id":"deco-3jm","title":"Write tests for QueryEngine filter","description":"TDD: Write failing tests for node filtering. Test: filter by kind, status, tags, combined filters, empty results.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:26:05.1882792+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4092503+01:00","closed_at":"2026-01-31T15:10:50.1768357+01:00","dependencies":[{"issue_id":"deco-3jm","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:28:18.4800645+01:00","created_by":"Toernblom"}]}
{"id":"deco-3vb","title":"Write tests for deco unset command","description":"TDD: Write failing tests for unset command. Test: removes field, validates after unset, error on required field.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:26:14.8779699+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4118614+01:00","closed_at":"2026-01-31T15:56:13.0796839+01:00","dependencies":[{"issue_id":"deco-3vb","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:28:49.6834601+01:00","created_by":"Toernblom"},{"issue_id":"deco-3vb","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:28:51.1232099+01:00","created_by":"Toernblom"}]}
{"id":"deco-4ci","title":"Implement contract scenario parser","description":"Create internal/domain/contract.go with Contract, Scenario, Step types. Parse contract.scenarios from YAML into structured domain types.","status":"open","priority":4,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T14:01:54.5945054+01:00","created_by":"Anton","updated_at":"2026-01-31T14:01:54.5945054+01:00"}
{"id":"deco-4dj","title":"Write tests for suggestion engine","description":"TDD: Write failing tests for did-you-mean suggestions. Test: Levenshtein distance, threshold for suggestions, multiple candidates, no suggestion when too different.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:26:04.2601776+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4138745+01:00","closed_at":"2026-01-31T14:50:56.9098884+01:00","dependencies":[{"issue_id":"deco-4dj","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:29:07.0426019+01:00","created_by":"Toernblom"}]}
{"id":"deco-4p9","title":"Example projects + GDD playbook","description":"Goal: provide best-practice references for teams.\n\nAcceptance:\n- At least one example project that validates.\n- \"How to structure your GDD\" playbook added.","status":"open","priority":3,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T18:13:17.8836694+01:00","created_by":"Toernblom","updated_at":"2026-02-01T18:13:17.8836694+01:00","dependencies":[{"issue_id":"deco-4p9","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:13:18.2119821+01:00","created_by":"Toernblom"}]}
{"id":"deco-4q8","title":"Implement deco show command","description":"Create internal/cli/show.go. Show single node details including reverse refs (what uses this node).","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:14.9036249+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.414888+01:00","closed_at":"2026-01-31T15:45:14.6597206+01:00","dependencies":[{"issue_id":"deco-4q8","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:19:23.4887582+01:00","created_by":"Toernblom"},{"issue_id":"deco-4q8","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:19:27.2718993+01:00","created_by":"Toernblom"},{"issue_id":"deco-4q8","depends_on_id":"deco-s5c","type":"blocks","created_at":"2026-01-30T15:27:05.8585963+01:00","created_by":"Toernblom"}]}
{"id":"deco-513","title":"Add deco create command for scaffolding nodes","description":"Add a 'deco create \u003cid\u003e' command that scaffolds a new node with required fields. Could support --kind flag and optionally --template for predefined node templates.","status":"closed","priority":3,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T16:32:04.3383951+01:00","created_by":"Anton","updated_at":"2026-02-01T18:18:02.7422495+01:00","closed_at":"2026-02-01T18:18:02.7422495+01:00","close_reason":"Closed"}
{"id":"deco-53i","title":"Implement deco set command","description":"Create internal/cli/set.go. Patch a node field: deco set \u003cid\u003e \u003cpath\u003e \u003cvalue\u003e. Validate after patch.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:26.5019848+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4163276+01:00","closed_at":"2026-01-31T15:53:52.8632162+01:00","dependencies":[{"issue_id":"deco-53i","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:19:23.8844202+01:00","created_by":"Toernblom"},{"issue_id":"deco-53i","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:19:27.6459412+01:00","created_by":"Toernblom"},{"issue_id":"deco-53i","depends_on_id":"deco-0jp","type":"blocks","created_at":"2026-01-30T15:27:09.7824719+01:00","created_by":"Toernblom"}]}
{"id":"deco-53k","title":"Write tests for YAML NodeRepository","description":"TDD: Write failing tests for YAML file-based node repository. Test: LoadAll, Load(id), Save(node), Delete(id), Exists(id), handling missing files, invalid YAML, nested directories.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:18.5214424+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4187755+01:00","closed_at":"2026-01-31T14:32:29.0023396+01:00","dependencies":[{"issue_id":"deco-53k","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:27:54.940438+01:00","created_by":"Toernblom"}]}
{"id":"deco-5fv","title":"Implement error aggregation","description":"Create internal/errors/collector.go. Collect multiple errors during validation, sort by file and line, deduplicate related errors.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:30.5574996+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.41978+01:00","closed_at":"2026-01-31T14:57:34.6756694+01:00","dependencies":[{"issue_id":"deco-5fv","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:19:24.4836887+01:00","created_by":"Toernblom"},{"issue_id":"deco-5fv","depends_on_id":"deco-5wv","type":"blocks","created_at":"2026-01-30T15:27:00.694157+01:00","created_by":"Toernblom"}]}
{"id":"deco-5ns","title":"Define ConfigRepository interface","description":"Create internal/storage/config/repository.go with interface: Load, Save for project config.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:15.7963863+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4219985+01:00","closed_at":"2026-01-31T14:20:51.2956382+01:00"}
{"id":"deco-5ry","title":"Implement file discovery for nodes","description":"Walk .deco/nodes/ directory tree, discover all .yaml files, map file paths to node IDs based on relative path.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:14:42.6400318+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4232888+01:00","closed_at":"2026-01-31T14:35:19.6454745+01:00","dependencies":[{"issue_id":"deco-5ry","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:19:14.379321+01:00","created_by":"Toernblom"},{"issue_id":"deco-5ry","depends_on_id":"deco-344","type":"blocks","created_at":"2026-01-30T15:26:50.5039701+01:00","created_by":"Toernblom"}]}
{"id":"deco-5uc","title":"Add deco graph command to visualize dependencies","description":"Add a 'deco graph' command that outputs the node dependency graph. Support DOT/Graphviz format for visualization. Could also support --format=mermaid for Markdown embedding.","status":"open","priority":3,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T16:32:09.1455785+01:00","created_by":"Anton","updated_at":"2026-01-31T16:32:09.1455785+01:00"}
{"id":"deco-5wv","title":"Write tests for error aggregation","description":"TDD: Write failing tests for error collection. Test: multiple errors collected, sorted by file/line, deduplication, max errors limit.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:26:06.2485657+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4246992+01:00","closed_at":"2026-01-31T14:57:34.6458749+01:00","dependencies":[{"issue_id":"deco-5wv","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:29:08.4772745+01:00","created_by":"Toernblom"}]}
{"id":"deco-5xa","title":"Errors: Rust-like error system","status":"closed","priority":1,"issue_type":"epic","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:14:11.954489+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4263752+01:00","closed_at":"2026-01-31T14:57:43.1206952+01:00","dependencies":[{"issue_id":"deco-5xa","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:17:35.3836073+01:00","created_by":"Toernblom"},{"issue_id":"deco-5xa","depends_on_id":"deco-03s","type":"blocks","created_at":"2026-01-30T15:18:40.8406314+01:00","created_by":"Toernblom"},{"issue_id":"deco-5xa","depends_on_id":"deco-7cp","type":"blocks","created_at":"2026-01-30T15:18:41.0314094+01:00","created_by":"Toernblom"},{"issue_id":"deco-5xa","depends_on_id":"deco-e9t","type":"blocks","created_at":"2026-01-30T15:18:41.2264361+01:00","created_by":"Toernblom"},{"issue_id":"deco-5xa","depends_on_id":"deco-m9l","type":"blocks","created_at":"2026-01-30T15:18:41.440049+01:00","created_by":"Toernblom"},{"issue_id":"deco-5xa","depends_on_id":"deco-3ip","type":"blocks","created_at":"2026-01-30T15:18:41.6437292+01:00","created_by":"Toernblom"},{"issue_id":"deco-5xa","depends_on_id":"deco-5fv","type":"blocks","created_at":"2026-01-30T15:18:41.8418082+01:00","created_by":"Toernblom"},{"issue_id":"deco-5xa","depends_on_id":"deco-inq","type":"blocks","created_at":"2026-01-30T15:18:42.0468131+01:00","created_by":"Toernblom"}]}
{"id":"deco-603","title":"Add type-specific validation for blocks (rule/table/param/etc.)","description":"Goal: Prevent structurally invalid blocks from passing validation.\n\nExamples:\n- rule blocks require text\n- table blocks require columns and rows\n- param blocks require name/datatype/min/max as applicable\n\nAcceptance:\n- Validator enforces required fields per block type.\n- Errors are clear and point to the offending block.\n- Tests cover each block type.","status":"open","priority":2,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T17:32:42.5421303+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:32:42.5421303+01:00","dependencies":[{"issue_id":"deco-603","depends_on_id":"deco-cxk","type":"blocks","created_at":"2026-02-01T17:34:02.1566712+01:00","created_by":"Toernblom"},{"issue_id":"deco-603","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:08:11.8240162+01:00","created_by":"Toernblom"}]}
{"id":"deco-6iv","title":"Deco GDD: Project-lead vision for end-state product","description":"Vision\nAs a project lead, I want Deco to be the authoritative, auditable, low‑friction system for creating and maintaining game design documents (GDDs). It should be strict enough to prevent ambiguity and drift, yet ergonomic for daily authoring, collaboration, and AI‑assisted workflows.\n\nPrimary Outcomes\n- Single source of truth for design, with schema‑level guarantees and traceable changes.\n- Fast authoring and refactoring without fear of silent data loss.\n- Validation that catches structural/design errors early and points directly to the fix.\n- Clear workflows for drafts → review → approved/published.\n\nCore Authoring Features (Missing / Incomplete)\n- Canonical block schema (inline fields vs data map) with zero data loss on load/save.\n- Strict top‑level schema validation with explicit extension namespace (`custom` or `x_*`).\n- Type‑specific validation for blocks (rule/table/param/mechanic/list, etc.).\n- Status‑aware validation (draft relaxed, approved/published strict).\n- Robust duplicate ID detection + helpful remediation.\n- Rich error context (file:line:col + snippet) in validate output.\n- Safe patching for nested paths (no panics), including pointer fields and map/slice updates.\n- Typed `set/append/unset` with JSON/YAML parsing for non‑string fields.\n\nProject Management \u0026 Collaboration\n- Issue/TBD system: list, filter, severity, and per‑node issue tracking.\n- Review workflow: approvals, status transitions, and changelog notes.\n- Audit trail with who/what/when, and readable history diff per node.\n- Conflict detection for concurrent edits.\n\nNavigation \u0026 Discovery\n- Strong query language (kind/status/tags/refs/text) with saved queries.\n- Graph visualization of dependencies and reverse references.\n- Stats/health report (coverage, missing content, orphan nodes).\n\nSchema \u0026 Extensibility\n- Configurable schema rules (org‑level constraints).\n- Custom block types with validation hooks.\n- CEL constraints scoped by node kinds and patterns.\n\nAI Workflow Support\n- Patch/rewrite modes are safe and transactional.\n- Validation gate before write; explicit diffs for review.\n- “Explain error” and “suggest fix” outputs for AI/humans.\n\nDocs \u0026 Examples\n- README/SPEC aligned with actual schema and CLI behaviors.\n- Example projects that validate and demonstrate best practices.\n- “How to structure your GDD” playbook.\n\nQuality \u0026 Non‑Functional\n- Deterministic load/save (no reordering surprises).\n- Validation performance on large projects.\n- Backwards‑compatible migrations for schema updates.\n- Robust tests for validator, patcher, and CLI.\n\nAcceptance Criteria (for epic completion)\n- All blocking issues resolved (schema mismatch, validation gaps, CLI crashes).\n- Strict validation with clear error locations by default.\n- Authoring flows validated end‑to‑end (create/edit/validate/history).\n- Example projects round‑trip without data loss.\n- Docs reflect behavior and are consistent with tests.","status":"open","priority":2,"issue_type":"epic","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T17:39:13.9458883+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:39:13.9458883+01:00"}
{"id":"deco-6j1","title":"Implement deco history command","description":"Create internal/cli/history.go. Show audit log, optionally filtered by node ID.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:49.8683388+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4274399+01:00","closed_at":"2026-01-31T16:00:33.8825087+01:00","dependencies":[{"issue_id":"deco-6j1","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:19:24.7152993+01:00","created_by":"Toernblom"},{"issue_id":"deco-6j1","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:19:28.4146423+01:00","created_by":"Toernblom"},{"issue_id":"deco-6j1","depends_on_id":"deco-7kj","type":"blocks","created_at":"2026-01-30T15:27:16.6201419+01:00","created_by":"Toernblom"}]}
{"id":"deco-747","title":"Write tests for deco mv command","description":"TDD: Write failing tests for mv command. Test: renames node, updates all refs, moves file, creates history entry.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:26:16.5261901+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4296386+01:00","closed_at":"2026-01-31T16:10:45.0062801+01:00","dependencies":[{"issue_id":"deco-747","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:28:52.6600918+01:00","created_by":"Toernblom"},{"issue_id":"deco-747","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:28:54.1660366+01:00","created_by":"Toernblom"}]}
{"id":"deco-750","title":"Implement Patcher unset operation","description":"Create internal/service/patcher/unset.go. Remove field at path from node.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:31.3736821+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4307286+01:00","closed_at":"2026-01-31T15:04:15.4213536+01:00","dependencies":[{"issue_id":"deco-750","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:19:18.2900619+01:00","created_by":"Toernblom"},{"issue_id":"deco-750","depends_on_id":"deco-q41","type":"blocks","created_at":"2026-01-30T15:27:08.8290604+01:00","created_by":"Toernblom"}]}
{"id":"deco-77y","title":"Write tests for ConfigRepository","description":"TDD: Write failing tests for config repository. Test: Load, Save, missing config file handling, invalid config, default values.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:22.4680827+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4324467+01:00","closed_at":"2026-01-31T14:36:15.017427+01:00","dependencies":[{"issue_id":"deco-77y","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:27:57.8340902+01:00","created_by":"Toernblom"}]}
{"id":"deco-79k","title":"Enforce constraint scope (node kind/pattern) in validator","description":"Goal: respect Constraint.scope for CEL constraints.\n\nAcceptance:\n- Constraints apply only to matching node kinds/patterns.\n- Non-matching nodes are skipped.\n- Tests cover scope matching rules.","status":"open","priority":2,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T18:13:15.0241417+01:00","created_by":"Toernblom","updated_at":"2026-02-01T18:13:15.0241417+01:00","dependencies":[{"issue_id":"deco-79k","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:13:15.354472+01:00","created_by":"Toernblom"}]}
{"id":"deco-7au","title":"Setup Cobra root command","description":"Create cmd/deco/main.go and internal/cli/root.go. Initialize Cobra with root command, version flag, global flags.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:14:54.8794474+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4345405+01:00","closed_at":"2026-01-31T15:29:53.5191667+01:00","dependencies":[{"issue_id":"deco-7au","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:19:22.576821+01:00","created_by":"Toernblom"},{"issue_id":"deco-7au","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:19:26.5107344+01:00","created_by":"Toernblom"},{"issue_id":"deco-7au","depends_on_id":"deco-336","type":"blocks","created_at":"2026-01-30T15:26:51.3058289+01:00","created_by":"Toernblom"}]}
{"id":"deco-7ba","title":"Implement deco init command","description":"Create internal/cli/init.go. Initialize .deco/ directory with config.yaml and nodes/ folder. Check for existing project.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:14:59.434768+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4355859+01:00","closed_at":"2026-01-31T15:29:53.5793939+01:00","dependencies":[{"issue_id":"deco-7ba","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:19:22.7796292+01:00","created_by":"Toernblom"},{"issue_id":"deco-7ba","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:19:26.6998482+01:00","created_by":"Toernblom"},{"issue_id":"deco-7ba","depends_on_id":"deco-sz1","type":"blocks","created_at":"2026-01-30T15:26:54.7843336+01:00","created_by":"Toernblom"}]}
{"id":"deco-7cp","title":"Create error code registry","description":"Create internal/errors/codes.go. Define error codes E001-E099 with constants and descriptions. Categories: schema (E001-E019), refs (E020-E039), constraints (E040-E059), parse (E060-E079).","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:09.0955285+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4374744+01:00","closed_at":"2026-01-31T14:28:38.8900755+01:00","dependencies":[{"issue_id":"deco-7cp","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:19:23.6779634+01:00","created_by":"Toernblom"},{"issue_id":"deco-7cp","depends_on_id":"deco-8sd","type":"blocks","created_at":"2026-01-30T15:26:47.2426051+01:00","created_by":"Toernblom"}]}
{"id":"deco-7de","title":"Session handover: Error system and storage layer complete","notes":"## Session Accomplishments (2026-01-31)\n\n### Completed Issues (12 total, bringing total to 31/100):\n\n**Error System (Complete Core):**\n1. **deco-03s**: DecoError structure with Rust-like pattern\n   - Implemented Code, Summary, Detail, Location, Context, Suggestion, Related fields\n   - Error() method for string representation\n\n2. **deco-8sd/deco-7cp**: Error code registry\n   - Defined E001-E099 error codes organized by category\n   - Categories: schema, refs, validation, io, graph (E001-E019 per category)\n   - Registry with Lookup, AllCodes, ByCategory, Categories methods\n\n3. **deco-yu5/deco-e9t**: Error formatter\n   - Rust-like formatting with ANSI colors\n   - Source context display with line numbers and column pointers\n   - FormatWithSource for showing code snippets\n   - FormatMultiple for error aggregation\n\n4. **deco-inq**: Error documentation generator\n   - Markdown generation for error code documentation\n   - GenerateMarkdown, GenerateDetailedMarkdown, GenerateCodeList methods\n   - Filters out reserved error codes\n\n**Storage Layer (NodeRepository + ConfigRepository):**\n5. **deco-53k/deco-nkw**: YAML NodeRepository\n   - Full CRUD: LoadAll, Load, Save, Delete, Exists\n   - Nested directory support (e.g., systems/food.yaml)\n   - Error handling for missing files, invalid YAML\n\n6. **deco-344/deco-5ry**: File discovery for nodes\n   - DiscoverAll for walking directory tree\n   - DiscoverByPattern for filtered discovery\n   - PathToID and IDToPath conversion utilities\n\n7. **deco-77y/deco-px9**: ConfigRepository\n   - Load/Save project configuration\n   - Support for custom fields\n   - Default values handling\n\n### Project State:\n- **Tests:** All passing (domain + storage layers)\n- **Coverage:** 31/100 issues closed (31%)\n- **Working tree:** Clean, all changes committed and pushed\n- **Dependencies:** Added gopkg.in/yaml.v3 for YAML parsing\n\n### Architecture Progress:\n```\n✅ Domain Layer: Complete (Node, Graph, Issue, Constraint, Ref, AuditEntry, DecoError)\n✅ Error System: Core complete (structure, registry, formatter, docs)\n   ⏳ Remaining: suggestion engine, error aggregation, YAML context extraction\n✅ Storage Interfaces: Complete (NodeRepository, ConfigRepository, HistoryRepository)\n✅ NodeRepository: Complete (YAML implementation + file discovery)\n✅ ConfigRepository: Complete (YAML implementation)\n⏳ HistoryRepository: Tests + implementation needed\n⏳ Service Layer: Not started (depends on storage completion)\n⏳ CLI Layer: Not started (depends on service + errors)\n```\n\n## Next Steps (Recommended Priority):\n\n### Immediate: Complete Storage Layer\nContinue with remaining repository implementations:\n\n1. **deco-hxq/deco-owf**: HistoryRepository (tests + impl)\n   - Append-only audit log\n   - Query with filtering\n   - JSONL format\n\n2. **deco-1jc/deco-nbv**: YAML line number tracking (tests + impl)\n   - Preserve source locations for error reporting\n   - Integration with DecoError Location field\n\n3. **deco-mvn/deco-m9l**: YAML context extraction (tests + impl)\n   - Extract code context around error locations\n   - Integration with error formatter\n\n### Then: Complete Error System\nFinish remaining error system components:\n\n4. **deco-4dj/deco-3ip**: Suggestion engine (tests + impl)\n   - Generate helpful suggestions based on error context\n   - Integration with DecoError Suggestion field\n\n5. **deco-5wv/deco-5fv**: Error aggregation (tests + impl)\n   - Collect and group related errors\n   - Prevent error cascades\n\n### Then: Service Layer\nAfter storage layer is complete, start on services:\n\n6. **deco-jxy**: GraphBuilder service\n7. **deco-0s1/deco-oam**: QueryEngine\n8. **deco-7yp/deco-h9q**: Patcher service\n9. **deco-az1/deco-2t4/deco-xw8/deco-eft**: Validator orchestrator\n\n## Technical Notes:\n\n### Error System Design:\n- Following Rust compiler error format\n- DecoError is the core error type used throughout\n- ErrorFormatter provides rich, colorized output\n- Error codes E001-E099 organized by category with room for expansion\n\n### Storage Layer Design:\n- Repository pattern for clean abstraction\n- YAML as primary persistence format\n- File-based organization: .deco/nodes/{id}.yaml, .deco/config.yaml, .deco/history.jsonl\n- Support for nested directories matching node ID structure\n\n### Testing Approach:\n- Strict TDD: tests written before implementation\n- All tests use t.TempDir() for isolation\n- Comprehensive coverage of edge cases (missing files, invalid YAML, nested paths)\n\n## Ready to Work:\nRun `bd ready` to see available tasks. Next session should focus on completing the storage layer before moving to services.","status":"closed","priority":0,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T14:37:28.3847548+01:00","created_by":"Anton","updated_at":"2026-01-31T14:41:52.8956564+01:00","closed_at":"2026-01-31T14:41:52.8956564+01:00","close_reason":"Closed"}
{"id":"deco-7jb","title":"Expand test coverage for validator/patcher/CLI","description":"Goal: increase confidence in core workflows.\n\nAcceptance:\n- Additional tests for edge cases in validator, patcher, CLI.\n- CI coverage report updated (if available).","status":"open","priority":3,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T18:14:04.9799205+01:00","created_by":"Toernblom","updated_at":"2026-02-01T18:14:04.9799205+01:00","dependencies":[{"issue_id":"deco-7jb","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:14:05.3323893+01:00","created_by":"Toernblom"}]}
{"id":"deco-7kj","title":"Write tests for deco history command","description":"TDD: Write failing tests for history command. Test: shows all history, --node filter, --limit flag, output format.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:26:18.9474827+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4390963+01:00","closed_at":"2026-01-31T15:59:30.4954685+01:00","dependencies":[{"issue_id":"deco-7kj","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:28:55.6079891+01:00","created_by":"Toernblom"},{"issue_id":"deco-7kj","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:28:57.0479017+01:00","created_by":"Toernblom"}]}
{"id":"deco-7rp","title":"Implement Patcher set operation","description":"Create internal/service/patcher/set.go. Set a field value at a path in a node. Validate path exists.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:18.7011961+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4401565+01:00","closed_at":"2026-01-31T15:04:15.3518278+01:00","dependencies":[{"issue_id":"deco-7rp","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:19:17.9041119+01:00","created_by":"Toernblom"},{"issue_id":"deco-7rp","depends_on_id":"deco-aoo","type":"blocks","created_at":"2026-01-30T15:27:05.0143236+01:00","created_by":"Toernblom"}]}
{"id":"deco-7yo","title":"CLI: Command implementations","status":"closed","priority":1,"issue_type":"epic","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:14:10.4055217+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4421742+01:00","closed_at":"2026-01-31T16:12:53.0249789+01:00","dependencies":[{"issue_id":"deco-7yo","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:17:35.1896881+01:00","created_by":"Toernblom"},{"issue_id":"deco-7yo","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:17:38.3548603+01:00","created_by":"Toernblom"},{"issue_id":"deco-7yo","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:17:38.5647768+01:00","created_by":"Toernblom"},{"issue_id":"deco-7yo","depends_on_id":"deco-7au","type":"blocks","created_at":"2026-01-30T15:18:41.8969151+01:00","created_by":"Toernblom"},{"issue_id":"deco-7yo","depends_on_id":"deco-7ba","type":"blocks","created_at":"2026-01-30T15:18:42.0976771+01:00","created_by":"Toernblom"},{"issue_id":"deco-7yo","depends_on_id":"deco-1fm","type":"blocks","created_at":"2026-01-30T15:18:42.3220117+01:00","created_by":"Toernblom"},{"issue_id":"deco-7yo","depends_on_id":"deco-qll","type":"blocks","created_at":"2026-01-30T15:18:42.5120137+01:00","created_by":"Toernblom"},{"issue_id":"deco-7yo","depends_on_id":"deco-4q8","type":"blocks","created_at":"2026-01-30T15:18:42.7026104+01:00","created_by":"Toernblom"},{"issue_id":"deco-7yo","depends_on_id":"deco-1eg","type":"blocks","created_at":"2026-01-30T15:18:42.8983197+01:00","created_by":"Toernblom"},{"issue_id":"deco-7yo","depends_on_id":"deco-53i","type":"blocks","created_at":"2026-01-30T15:18:43.0884948+01:00","created_by":"Toernblom"},{"issue_id":"deco-7yo","depends_on_id":"deco-1v8","type":"blocks","created_at":"2026-01-30T15:18:43.2838246+01:00","created_by":"Toernblom"},{"issue_id":"deco-7yo","depends_on_id":"deco-31k","type":"blocks","created_at":"2026-01-30T15:18:43.4717154+01:00","created_by":"Toernblom"},{"issue_id":"deco-7yo","depends_on_id":"deco-vzo","type":"blocks","created_at":"2026-01-30T15:18:43.6601064+01:00","created_by":"Toernblom"},{"issue_id":"deco-7yo","depends_on_id":"deco-6j1","type":"blocks","created_at":"2026-01-30T15:18:43.8516144+01:00","created_by":"Toernblom"},{"issue_id":"deco-7yo","depends_on_id":"deco-0kr","type":"blocks","created_at":"2026-01-30T15:18:44.039727+01:00","created_by":"Toernblom"},{"issue_id":"deco-7yo","depends_on_id":"deco-c5c","type":"blocks","created_at":"2026-01-30T15:18:44.2400364+01:00","created_by":"Toernblom"}]}
{"id":"deco-7yp","title":"Implement Patcher apply operation","description":"Create internal/service/patcher/apply.go. Apply a patch file (JSON patch format) to nodes.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:36.6779196+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.443808+01:00","closed_at":"2026-01-31T15:09:09.6445563+01:00","dependencies":[{"issue_id":"deco-7yp","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:19:18.5299032+01:00","created_by":"Toernblom"},{"issue_id":"deco-7yp","depends_on_id":"deco-h9q","type":"blocks","created_at":"2026-01-30T15:27:10.7341971+01:00","created_by":"Toernblom"}]}
{"id":"deco-86e","title":"Block data lost when parsing YAML (blocks[].data null)","description":"Repro:\n1) cd examples\\snake\n2) deco show systems/core --json\n3) content.sections[*].blocks[*].data is null even though YAML defines text/columns/rows.\n\nExpected: block fields are preserved (either inline fields mapped into data, or schema uses explicit data: ... and docs/examples follow).\nActual: unknown block keys are dropped by yaml.Unmarshal, so content is lost and re-saving would strip it.\nRefs: internal/domain/node.go (Block has Data only); README example and examples/snake use inline block fields.","status":"closed","priority":1,"issue_type":"bug","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T17:29:45.5530814+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:49:59.3754096+01:00","closed_at":"2026-02-01T17:49:59.3754096+01:00","close_reason":"Fixed by implementing custom Block YAML marshaling/unmarshaling that preserves all inline fields in Data map","dependencies":[{"issue_id":"deco-86e","depends_on_id":"deco-cxk","type":"blocks","created_at":"2026-02-01T17:33:28.9350356+01:00","created_by":"Toernblom"},{"issue_id":"deco-86e","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:08:09.5354447+01:00","created_by":"Toernblom"}]}
{"id":"deco-87y","title":"Custom block types with validation hooks","description":"Goal: extend content blocks beyond core types.\n\nAcceptance:\n- Config defines custom block types + required fields.\n- Validator enforces per custom type.\n- Example demonstrates a custom block.","status":"open","priority":2,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T18:13:14.312993+01:00","created_by":"Toernblom","updated_at":"2026-02-01T18:13:14.312993+01:00","dependencies":[{"issue_id":"deco-87y","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:13:14.6377494+01:00","created_by":"Toernblom"}]}
{"id":"deco-8ca","title":"Define AuditEntry domain type","description":"Create internal/domain/history.go for audit log entries. Fields: Timestamp, Operation, NodeID, User, Before, After.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:05.5656486+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4448147+01:00","closed_at":"2026-01-31T14:19:52.5069805+01:00","dependencies":[{"issue_id":"deco-8ca","depends_on_id":"deco-1er","type":"blocks","created_at":"2026-01-30T15:25:39.2814313+01:00","created_by":"Toernblom"}]}
{"id":"deco-8ov","title":"validate does not detect duplicate node IDs","description":"Repro:\n1) Copy any node file to a new filename but keep the same id field (e.g., systems/core.yaml -\u003e systems/core-dup.yaml with id: systems/core).\n2) Run: deco validate \u003cdir\u003e\n\nActual: validates successfully.\nExpected: validation should fail because node IDs must be unique; duplicates cause ambiguous references and data loss.\nRefs: internal/services/validator/validator.go.","status":"closed","priority":2,"issue_type":"bug","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T17:30:04.1511602+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:46:23.8155419+01:00","closed_at":"2026-02-01T17:46:23.8155419+01:00","close_reason":"Added DuplicateIDValidator to detect duplicate node IDs during validation","dependencies":[{"issue_id":"deco-8ov","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:08:10.0438008+01:00","created_by":"Toernblom"}]}
{"id":"deco-8rt","title":"Session handover: CLI mutation commands complete","notes":"## Session Accomplishments (2026-01-31)\n\n### Completed: CLI Mutation Commands (12 issues closed)\n\n**Query Command (2 issues):**\n1. **deco-vz6**: Write tests for deco query command - 24 tests\n2. **deco-1eg**: Implement deco query command\n   - Text search in title/summary (case-insensitive)\n   - Combined with kind/status/tag filters\n   - Same table output as list\n\n**Set Command (2 issues):**\n3. **deco-0jp**: Write tests for deco set command - 20 tests\n4. **deco-53i**: Implement deco set command\n   - Set field values using Patcher.Set()\n   - Supports simple fields and array indices\n   - Auto-increments version\n\n**Append Command (2 issues):**\n5. **deco-zix**: Write tests for deco append command - 19 tests\n6. **deco-1v8**: Implement deco append command\n   - Append values to array fields\n   - Auto-increments version\n\n**Unset Command (2 issues):**\n7. **deco-3vb**: Write tests for deco unset command - 22 tests\n8. **deco-31k**: Implement deco unset command\n   - Remove field values or array elements\n   - Protects required fields (id, kind, version, status, title)\n   - Auto-increments version\n\n**Apply Command (2 issues):**\n9. **deco-tzg**: Write tests for deco apply command - 24 tests\n10. **deco-0kr**: Implement deco apply command\n    - Batch operations from JSON file\n    - Transactional (rollback on error)\n    - --dry-run flag for validation\n\n**History Command (2 issues):**\n11. **deco-7kj**: Write tests for deco history command - 17 tests\n12. **deco-6j1**: Implement deco history command\n    - View audit log entries\n    - Filter by --node and --limit\n\n### Project State:\n- **Tests:** All passing (146+ new CLI tests)\n- **Working tree:** Clean, ready to push\n- **Commands now available:**\n  - init, validate, list, show, query\n  - set, append, unset, apply\n  - history\n\n### Next Steps:\n1. **deco-bhb/deco-142**: Node rename service (needed for mv command)\n2. **deco-747/deco-vzo**: Mv command (depends on rename service)\n3. **deco-c5c**: Shell completion generation","status":"closed","priority":0,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T16:01:01.1003631+01:00","created_by":"Anton","updated_at":"2026-01-31T16:07:34.8018863+01:00","closed_at":"2026-01-31T16:07:34.8018863+01:00","close_reason":"Session context absorbed into new handover"}
{"id":"deco-8sd","title":"Write tests for error code registry","description":"TDD: Write failing tests for error codes. Test: code uniqueness, code lookup, category ranges (schema E001-E019, refs E020-E039, etc).","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:53.192449+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4464815+01:00","closed_at":"2026-01-31T14:27:48.2870317+01:00","dependencies":[{"issue_id":"deco-8sd","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:29:02.7671393+01:00","created_by":"Toernblom"}]}
{"id":"deco-8vg","title":"Session handover: Storage and error system enhancements complete","notes":"## Session Accomplishments (2026-01-31)\n\n### Completed Issues (10 total, bringing total to 41/101 - 40.6%):\n\n**Storage Layer Complete:**\n1. **deco-hxq/deco-owf**: HistoryRepository (tests + implementation)\n   - Append-only JSONL format at .deco/history.jsonl\n   - Thread-safe concurrent writes with mutex\n   - Filtering by NodeID, Operation, User, time range, limit\n   - 15 comprehensive tests, all passing\n\n**Error System Enhancements:**\n2. **deco-1jc/deco-nbv**: YAML line number tracking (tests + implementation)\n   - LocationTracker using yaml.v3 Node with line/column info\n   - Path-based location lookup (dot notation + array indexing)\n   - Support for nested structures, multiline values\n   - GetLocation() and GetValueLocation() methods\n   - 13 comprehensive tests, all passing\n\n3. **deco-mvn/deco-m9l**: YAML context extraction (tests + implementation)\n   - ExtractContext() for surrounding lines\n   - HighlightColumn() for visual error pointers\n   - Edge case handling (start/end of file, CRLF)\n   - Indentation preservation for accurate display\n   - 15 comprehensive tests, all passing\n\n4. **deco-4dj/deco-3ip**: Suggestion engine (tests + implementation)\n   - Levenshtein distance calculation for typo detection\n   - Smart suggestions with 'did you mean?' formatting\n   - Threshold filtering, length similarity scoring\n   - Prefix bonus for better matching\n   - 17 comprehensive tests, all passing\n\n**Epic Closed:**\n5. **deco-elv**: Storage layer epic (all repository implementations complete)\n\n### Project State:\n- **Tests:** All passing (60 total tests across domain, errors, storage)\n- **Coverage:** 41/101 issues closed (40.6%)\n- **Working tree:** Clean, ready to commit\n- **New packages:**\n  - internal/errors/ (suggestions.go)\n  - internal/errors/yaml/ (location.go, context.go)\n  - internal/storage/history/ (jsonl_repository.go)\n\n### Architecture Progress:\n```\n✅ Domain Layer: Complete (Node, Graph, Issue, Constraint, Ref, AuditEntry, DecoError)\n✅ Error System: Enhanced with YAML integration\n   ✅ Core: structure, registry, formatter, docs\n   ✅ YAML: line tracking, context extraction\n   ✅ Suggestions: Levenshtein-based typo suggestions\n   ⏳ Remaining: error aggregation\n✅ Storage Layer: Complete (all repositories implemented)\n   ✅ NodeRepository: YAML + file discovery\n   ✅ ConfigRepository: YAML\n   ✅ HistoryRepository: JSONL append-only\n⏳ Service Layer: Not started (ready to begin)\n⏳ CLI Layer: Not started\n```\n\n## Next Steps (Recommended Priority):\n\n### Immediate: Complete Error System\n1. **deco-5wv/deco-5fv**: Error aggregation (tests + impl)\n   - Collect and group related errors\n   - Prevent error cascades\n   - Integration with DecoError\n\n### Then: Service Layer\nAfter error system is complete, services are unblocked:\n\n2. **deco-jxy/deco-0o3**: GraphBuilder service (tests + impl)\n   - Build dependency graph from nodes\n   - Detect cycles\n   - Topological sort\n\n3. **deco-3jm/deco-oam**: QueryEngine (tests + impl)\n   - Filter nodes by criteria\n   - Search by text\n   - Tag-based queries\n\n4. **deco-h9q/deco-7yp**: Patcher service (tests + impl)\n   - Apply operations to nodes\n   - Set, append, unset, move operations\n   - Atomic updates\n\n5. **deco-az1/deco-2y3**: Validator orchestrator (tests + impl)\n   - Coordinate schema, reference, constraint validation\n   - Collect and format errors\n   - Integration with suggestion engine\n\n### Then: CLI Layer\nAfter services are ready, build the user-facing commands.\n\n## Technical Notes:\n\n### HistoryRepository Design:\n- JSONL format (one JSON object per line)\n- Thread-safe with sync.Mutex\n- File location: .deco/history.jsonl\n- Chronological ordering on query\n- Efficient append-only operations\n\n### YAML Error Integration:\n- yaml.v3.Node preserves line/column info during parsing\n- LocationTracker maps paths to source locations\n- Context extraction for rich error display\n- Column highlighting with ^ pointers\n\n### Suggestion Engine:\n- Levenshtein distance for typo detection\n- Default threshold of 2 edits\n- Prefix matching bonus reduces distance\n- Length similarity as tiebreaker\n- Top 3 suggestions returned\n\n### Testing Approach:\n- Strict TDD: all tests written before implementation\n- Comprehensive edge case coverage\n- Tests use t.TempDir() for isolation\n- All 60 tests passing across packages\n\n## Ready to Work:\nRun `bd ready` to see available tasks. Next session should focus on completing error aggregation, then move to the service layer which is now unblocked.","status":"closed","priority":0,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T14:53:25.2476095+01:00","created_by":"Anton","updated_at":"2026-01-31T14:54:47.9005885+01:00","closed_at":"2026-01-31T14:54:47.9005885+01:00","close_reason":"Closed"}
{"id":"deco-934","title":"Session handover: CLI foundation complete","notes":"## Session Accomplishments (2026-01-31)\n\n### Completed: CLI Foundation (5 issues closed)\n\n**Cobra Root Command (2 issues):**\n1. **deco-336**: Write tests for Cobra root command\n   - Tests for version flag, help output, global flags, subcommand registration\n   - 13 comprehensive test cases, all passing\n\n2. **deco-7au**: Implement Cobra root command\n   - cmd/deco/main.go: CLI entry point\n   - internal/cli/root.go: Root command implementation\n   - Global flags: --config (-c), --verbose, --quiet (-q)\n   - Version flag: --version (-v)\n   - Automatic help generation\n\n**Init Command (2 issues):**\n3. **deco-sz1**: Write tests for deco init command\n   - Tests for directory creation, config generation, force flag\n   - Tests for existing project detection\n   - 19 comprehensive test cases, all passing\n\n4. **deco-7ba**: Implement deco init command\n   - internal/cli/init.go: Init command implementation\n   - Creates .deco/ directory structure\n   - Generates config.yaml with sensible defaults\n   - Creates nodes/ subdirectory\n   - --force (-f) flag to reinitialize\n   - Accepts optional directory argument\n\n**Services Epic:**\n5. **deco-t6q**: Closed Services epic (core complete)\n   - All core services implemented and tested\n   - Node rename (deco-142) deferred to Phase 4\n   - Service layer ready for CLI implementation\n\n### Project State:\n- **Tests:** All passing (163 total tests)\n  - CLI: 5 root tests + 19 init tests = 24 tests\n  - Domain: 30 tests\n  - Errors: 38 tests\n  - Services: 102 tests\n  - Storage: 21 tests\n\n- **Coverage:** 76/104 issues closed (73%)\n- **Working tree:** Clean, pushed to remote (commit fa7ab4e)\n- **Dependencies:** Added github.com/spf13/cobra v1.10.2\n\n### Architecture Status:\n```\n✅ Domain Layer: Complete\n✅ Error System: Complete\n✅ Storage Layer: Complete\n✅ Service Layer: Complete (core)\n⏳ CLI Layer: Foundation complete, commands in progress\n   ✅ Root command: Help, version, global flags\n   ✅ Init command: Project initialization\n   ⏳ Validate command: Next priority\n   ⏳ List/Show commands: Read operations\n   ⏳ Set/Append/Unset/Apply: Mutation commands\n   ⏳ Query/History: Advanced features\n   ⏳ Mv command: Advanced (requires deco-142)\n```\n\n## Next Steps: CLI Commands - Phase 1\n\nThe CLI foundation is complete. Continue with core read commands:\n\n### Recommended Priority Order:\n\n**1. Validate Command (deco-sbk/deco-1fm)** - HIGHEST PRIORITY\n   - Use Validator Orchestrator from services\n   - Critical foundation for all mutation commands\n   - Tests schema, references, and constraints\n   - Issue IDs: deco-sbk (tests), deco-1fm (impl)\n\n**2. List Command (deco-wlu/deco-qll)**\n   - Use QueryEngine.Filter() for kind/status/tags\n   - List nodes with filtering\n   - Issue IDs: deco-wlu (tests), deco-qll (impl)\n\n**3. Show Command (deco-s5c/deco-4q8)**\n   - Display node details\n   - Use GraphBuilder for reverse references\n   - Issue IDs: deco-s5c (tests), deco-4q8 (impl)\n\n**4. Query Command (deco-vz6/deco-1eg)**\n   - Advanced filtering and search\n   - Use QueryEngine.Filter() + Search()\n   - Issue IDs: deco-vz6 (tests), deco-1eg (impl)\n\n### Phase 2: Mutation Commands (After Validate)\n\n5. **Set** (deco-0jp/deco-53i): Use Patcher.Set()\n6. **Append** (deco-zix/deco-1v8): Use Patcher.Append()\n7. **Unset** (deco-3vb/deco-31k): Use Patcher.Unset()\n8. **Apply** (deco-tzg/deco-0kr): Use Patcher.Apply() for batch ops\n\n### Phase 3: Advanced Commands\n\n9. **History** (deco-7kj/deco-6j1): Use HistoryRepository\n10. **Mv** (deco-747/deco-vzo + deco-bhb/deco-142): Requires node rename service\n\n### Ready-to-Work Issues:\n```bash\nbd ready\n```\n\nCurrently 14 issues ready to work (no blockers).\n\n## Implementation Notes:\n\n### CLI Pattern Established:\n1. Write tests first (TDD)\n2. Test structure, flags, integration\n3. Implement command using services\n4. All commands use services, never direct storage access\n5. Clean separation: CLI → Services → Storage\n\n### Services Available:\n- **ConfigRepository**: Load/save project config\n- **NodeRepository**: Load/save/delete nodes\n- **HistoryRepository**: Audit log queries\n- **GraphBuilder**: Dependencies, cycles, topological sort, reverse index\n- **QueryEngine**: Filter (kind/status/tags), Search (text)\n- **Patcher**: Set, Append, Unset, Apply (batch with rollback)\n- **Validators**: Schema, Reference, Constraint, Orchestrator\n\n### Test Infrastructure:\n- Use t.TempDir() for isolated test directories\n- Pass directory argument to avoid os.Chdir() issues\n- Test all flags (long and short versions)\n- Test error cases and edge cases\n- Test integration with root command\n\n### Next Session Checklist:\n1. Start with validate command (deco-sbk)\n2. Follow TDD: write tests, verify failure, implement\n3. Use Validator Orchestrator from services\n4. Continue with list and show commands\n5. Build toward mutation commands\n\n## Technical Context:\n\n### Commit Message Format:\n```\n\u003csummary line\u003e\n\n\u003cdetailed changes\u003e\n\nCloses: \u003cissue-ids\u003e\nRelated: \u003crelated-issues\u003e\n\nCo-Authored-By: Claude Sonnet 4.5 \u003cnoreply@anthropic.com\u003e\n```\n\n### Running Commands:\n```bash\ngo test ./...              # All tests\ngo build ./cmd/deco        # Build binary\n./deco --help              # Test CLI\nbd ready                   # Find work\nbd show \u003cid\u003e               # View issue\nbd update \u003cid\u003e --status=in_progress  # Claim work\nbd close \u003cid\u003e              # Complete work\n```\n\n### Validation Command Priority:\nThe validate command is CRITICAL because:\n- All mutation commands should validate before AND after changes\n- Tests the full error system (codes, formatting, suggestions)\n- Exercises all three validators (schema, reference, constraint)\n- Provides confidence in data integrity\n- Required before implementing set/append/unset/apply commands","status":"closed","priority":0,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T15:31:25.0753185+01:00","created_by":"Anton","updated_at":"2026-01-31T15:33:38.4657329+01:00","closed_at":"2026-01-31T15:33:38.4657329+01:00","close_reason":"Closed"}
{"id":"deco-982","title":"Define Issue domain type","description":"Create internal/domain/issue.go for tracking TBDs/questions in nodes. Fields: ID, Severity, Message, Location, Resolved.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:14:48.7154145+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4475208+01:00","closed_at":"2026-01-31T14:19:52.4991645+01:00","dependencies":[{"issue_id":"deco-982","depends_on_id":"deco-0hm","type":"blocks","created_at":"2026-01-30T15:25:31.5279543+01:00","created_by":"Toernblom"}]}
{"id":"deco-9ls","title":"Implement constraint Validator","description":"Create internal/service/validator/constraints.go. Evaluate constraint expressions across nodes, report violations with both locations.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:08.2516794+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4497333+01:00","closed_at":"2026-01-31T15:18:53.1369731+01:00","dependencies":[{"issue_id":"deco-9ls","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:19:17.5029284+01:00","created_by":"Toernblom"},{"issue_id":"deco-9ls","depends_on_id":"deco-eft","type":"blocks","created_at":"2026-01-30T15:26:59.3609299+01:00","created_by":"Toernblom"}]}
{"id":"deco-9rm","title":"Compile GDD to LaTeX output","description":"Add a deco compile command that generates LaTeX output from the design graph. Should produce a professional, printable GDD document with proper formatting for tables, rules, parameters, and cross-references between nodes.","design":"# LaTeX Compile Feature Design\r\n\r\n**Issue:** deco-9rm\r\n**Date:** 2026-01-31\r\n**Status:** Approved\r\n\r\n## Overview\r\n\r\nAdd a `deco compile` command that generates a print-ready LaTeX GDD document from the design graph. Produces professional, typeset output suitable for stakeholders, publishers, or physical reference.\r\n\r\n## Command Interface\r\n\r\n```\r\ndeco compile -o \u003coutput.tex\u003e\r\n```\r\n\r\n**Flags:**\r\n- `-o, --output` (required): Output file path for the generated LaTeX\r\n\r\n**Behavior:**\r\n- Loads all nodes from `.deco/nodes/`\r\n- Validates project is initialized (`.deco/config.yaml` exists)\r\n- Generates a complete LaTeX document\r\n- Writes to the specified output file\r\n\r\n**Error cases:**\r\n- No `.deco/` directory → \"not a deco project, run deco init\"\r\n- No nodes found → \"no nodes to compile\"\r\n- Can't write output file → \"failed to write output: \u003creason\u003e\"\r\n\r\n## Document Structure\r\n\r\n```latex\r\n\\documentclass[11pt,a4paper]{report}\r\n% Preamble: packages for tables, colors, hyperlinks\r\n\r\n\\title{\u003cproject name from config\u003e}\r\n\\author{Generated by Deco}\r\n\\date{\\today}\r\n\r\n\\begin{document}\r\n\\maketitle\r\n\\tableofcontents\r\n\r\n\\chapter{Systems}\r\n  \\section{Settlement}\r\n    \\subsection{Colonists}\r\n      % Node content here\r\n\r\n\\chapter{Events}\r\n  % ...\r\n\\end{document}\r\n```\r\n\r\n**Hierarchy mapping:**\r\n- Top-level path segment → `\\chapter{}` (systems, events, etc.)\r\n- Second-level → `\\section{}`\r\n- Third-level → `\\subsection{}`\r\n- Deeper levels → `\\subsubsection{}` or bold headings\r\n\r\n**Ordering:** Alphabetical within each level.\r\n\r\n**Title casing:** Path segments capitalized. Node titles override when available.\r\n\r\n## Node Rendering\r\n\r\nEach node renders these elements:\r\n\r\n**Header area:**\r\n- Status badge: `[DRAFT]`, `[APPROVED]`, etc.\r\n- Tags as inline labels\r\n- Summary/one-liner in italics\r\n\r\n**Content blocks:**\r\n\r\n| Block Type | LaTeX Rendering |\r\n|------------|-----------------|\r\n| `table` | `tabular` with headers and borders |\r\n| `rule` | Indented block quote |\r\n| `param` | Key-value: **key**: value |\r\n| `mechanic` | Named box with description, conditions, outputs |\r\n| `list` | Bulleted `itemize` |\r\n\r\n**References section:**\r\n- \"Uses:\" with hyperlinked node IDs\r\n- \"Related:\" same treatment\r\n- Events and vocabulary if present\r\n\r\n**Issues section:**\r\n- Warning box at end of node\r\n- Shows TBD/question items with severity\r\n- Makes incomplete nodes visually obvious\r\n\r\n**Cross-references:** Node IDs become `\\hyperref` links.\r\n\r\n## Content Scope\r\n\r\n**Included:**\r\n- Meta (title, status, tags)\r\n- Summary\r\n- Content blocks (tables, rules, params, mechanics, lists)\r\n- References\r\n- Issues\r\n\r\n**Excluded:**\r\n- Contracts (implementation detail)\r\n- Constraints (internal validation)\r\n- llm_context (internal)\r\n\r\n## Implementation\r\n\r\n**Code organization:**\r\n\r\n```\r\ninternal/\r\n  cli/\r\n    compile.go          # Command definition, flags\r\n  services/\r\n    compile/\r\n      latex.go          # LaTeX generation logic\r\n      latex_test.go     # Unit tests\r\n```\r\n\r\n**Key components:**\r\n\r\n1. **LatexCompiler** - Main struct\r\n   - `Compile(nodes []domain.Node, config domain.Config) (string, error)`\r\n\r\n2. **Block renderers** - Per-type functions\r\n   - `renderTable()`, `renderRule()`, `renderParam()`, etc.\r\n\r\n**LaTeX packages:**\r\n- `hyperref` - Cross-references\r\n- `booktabs` - Tables\r\n- `xcolor` - Colors\r\n- `geometry` - Margins\r\n- `enumitem` - Lists\r\n- `tcolorbox` - Boxes for mechanics/issues\r\n\r\n**No external Go dependencies.** Pure string building with proper escaping of LaTeX special characters.\r\n\r\n## Testing\r\n\r\nUnit tests with example nodes verifying:\r\n- Correct document structure\r\n- Each block type renders properly\r\n- Special characters escaped\r\n- Cross-references generated\r\n\r\nNo PDF compilation in tests.","status":"open","priority":4,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T16:29:53.455703+01:00","created_by":"Anton","updated_at":"2026-01-31T16:49:52.4677092+01:00"}
{"id":"deco-a3o","title":"validate ignores unknown top-level keys and structural typos","description":"Repro:\n1) In a node YAML, change `content:` to `contentx:` or add a random top-level key.\n2) Run: deco validate \u003cdir\u003e\n\nActual: validation passes.\nExpected: validation should fail (or at least warn) for unknown top-level keys / missing known sections, to prevent silent corruption.\nExample: examples/snake/.deco/nodes/systems/core.yaml has `asdasdasd: 200` under a block and validate passes.\nRefs: internal/services/validator/validator.go.","status":"closed","priority":2,"issue_type":"bug","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T17:30:17.8448512+01:00","created_by":"Toernblom","updated_at":"2026-02-01T18:07:05.351702+01:00","closed_at":"2026-02-01T18:07:05.351702+01:00","close_reason":"Fixed: unknown top-level keys now trigger E010 validation error. Typos like 'contentx' are caught with suggestions. Tested with deco validate.","dependencies":[{"issue_id":"deco-a3o","depends_on_id":"deco-rib","type":"blocks","created_at":"2026-02-01T17:34:51.2606704+01:00","created_by":"Toernblom"},{"issue_id":"deco-a3o","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:08:10.2988867+01:00","created_by":"Toernblom"}]}
{"id":"deco-a5l","title":"AI patch/rewrite safety: validate gate + transactional apply + explicit diff","description":"Goal: AI changes are safe, validated, and reviewable.\n\nAcceptance:\n- Patch/rewrite operations are atomic.\n- Validation runs before write; failure aborts.\n- CLI can show diff of proposed changes.","status":"open","priority":2,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T18:13:15.7422929+01:00","created_by":"Toernblom","updated_at":"2026-02-01T18:13:15.7422929+01:00","dependencies":[{"issue_id":"deco-a5l","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:13:16.0730574+01:00","created_by":"Toernblom"}]}
{"id":"deco-a5n","title":"Explain error / suggest fix output","description":"Goal: make validation failures actionable for humans/AI.\n\nAcceptance:\n- Optional flag prints fix suggestions.\n- Errors reference doc links or hints when available.\n- Suggestions for common mistakes (typos, missing fields).","status":"open","priority":3,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T18:13:16.4590319+01:00","created_by":"Toernblom","updated_at":"2026-02-01T18:13:16.4590319+01:00","dependencies":[{"issue_id":"deco-a5n","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:13:16.7806681+01:00","created_by":"Toernblom"}]}
{"id":"deco-acy","title":"validate output lacks file/line context despite YAML location tracker","description":"Observed: deco validate prints only error summary text (no file/line), even though README examples show file/line context and a YAML location tracker exists.\nExpected: validation errors include file:line (and column when available) to match docs and speed fixing.\nRefs: internal/cli/validate.go (printing), internal/errors/yaml/location.go (tracker).","status":"open","priority":3,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T17:30:37.1321045+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:30:37.1321045+01:00","dependencies":[{"issue_id":"deco-acy","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:08:10.8029804+01:00","created_by":"Toernblom"}]}
{"id":"deco-ai9","title":"Deterministic load/save ordering","description":"Goal: avoid noisy diffs and surprising reorderings.\n\nAcceptance:\n- Save order stable across runs.\n- Map ordering deterministic (or normalized) where possible.","status":"open","priority":3,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T18:13:18.5923173+01:00","created_by":"Toernblom","updated_at":"2026-02-01T18:13:18.5923173+01:00","dependencies":[{"issue_id":"deco-ai9","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:13:18.9292106+01:00","created_by":"Toernblom"}]}
{"id":"deco-aoo","title":"Write tests for Patcher set operation","description":"TDD: Write failing tests for set operation. Test: set existing field, set nested field, set new field, invalid path handling.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:51.9602999+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4508834+01:00","closed_at":"2026-01-31T15:04:15.2556264+01:00","dependencies":[{"issue_id":"deco-aoo","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:28:10.8798429+01:00","created_by":"Toernblom"}]}
{"id":"deco-apc","title":"Configurable schema rules (org-level constraints)","description":"Goal: allow org/project to define additional schema rules.\n\nAcceptance:\n- Project config can declare required fields per kind.\n- Validation enforces these rules.\n- Documented in SPEC.","status":"open","priority":2,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T18:13:13.5972045+01:00","created_by":"Toernblom","updated_at":"2026-02-01T18:13:13.5972045+01:00","dependencies":[{"issue_id":"deco-apc","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:13:13.9228141+01:00","created_by":"Toernblom"}]}
{"id":"deco-az1","title":"Write tests for Validator orchestrator","description":"TDD: Write failing tests for combined validation. Test: all validators run, errors aggregated, proper ordering.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:47.6243971+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.451941+01:00","closed_at":"2026-01-31T15:15:40.7307682+01:00","dependencies":[{"issue_id":"deco-az1","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:28:09.4391835+01:00","created_by":"Toernblom"}]}
{"id":"deco-bhb","title":"Write tests for node rename","description":"TDD: Write failing tests for rename operation. Test: ID change, all refs updated, file moved, history entry created.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:26:10.6809002+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4540897+01:00","closed_at":"2026-01-31T16:05:59.4401619+01:00","dependencies":[{"issue_id":"deco-bhb","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:28:21.4406116+01:00","created_by":"Toernblom"}]}
{"id":"deco-bqg","title":"Define Node domain type","description":"Create internal/domain/node.go with Node struct: ID, Kind, Version, Status, Title, Tags, Refs, Content, Issues. Include Section and Block types.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:14:38.8091199+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4550972+01:00","closed_at":"2026-01-31T14:19:52.4939116+01:00","dependencies":[{"issue_id":"deco-bqg","depends_on_id":"deco-ora","type":"blocks","created_at":"2026-01-30T15:25:27.5609055+01:00","created_by":"Toernblom"}]}
{"id":"deco-bx5","title":"Implement schema Validator","description":"Create internal/service/validator/schema.go. Validate nodes against required fields: meta.id, meta.kind, meta.version, meta.status, meta.title.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:14:57.686703+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4565162+01:00","closed_at":"2026-01-31T15:18:53.068085+01:00","dependencies":[{"issue_id":"deco-bx5","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:19:17.0853346+01:00","created_by":"Toernblom"},{"issue_id":"deco-bx5","depends_on_id":"deco-2t4","type":"blocks","created_at":"2026-01-30T15:26:52.2252073+01:00","created_by":"Toernblom"}]}
{"id":"deco-c5c","title":"Add shell completion generation","description":"Add Cobra completion command for bash, zsh, fish, powershell.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:16:05.5466948+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4587148+01:00","closed_at":"2026-01-31T16:12:44.9059542+01:00","dependencies":[{"issue_id":"deco-c5c","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:19:25.124744+01:00","created_by":"Toernblom"},{"issue_id":"deco-c5c","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:19:28.8119102+01:00","created_by":"Toernblom"}]}
{"id":"deco-c5k","title":"Session handover: Foundation complete, error system next","notes":"## Session Accomplishments (2026-01-31)\n\n### Completed (18 issues closed):\n1. **deco-rba**: Initialized Go module and project structure\n   - Created folder structure: cmd/deco/, internal/{domain,storage,service,cli}/\n   - Enhanced .gitignore\n\n2. **Domain Types (TDD)** - All tests written first, then implementations:\n   - **deco-ora/deco-bqg**: Node domain type with validation\n   - **deco-shb/deco-zty**: Graph with CRUD operations\n   - **deco-0hm/deco-982**: Issue tracking (TBDs/questions)\n   - **deco-ll2/deco-lwx**: Constraint (CEL validation rules)\n   - **deco-xjv/deco-rrk**: Ref/RefLink (inter-node references)\n   - **deco-1er/deco-8ca**: AuditEntry (audit log)\n\n3. **Repository Interfaces**:\n   - **deco-p54**: NodeRepository (LoadAll, Load, Save, Delete, Exists)\n   - **deco-5ns**: ConfigRepository (Load, Save) + Config type\n   - **deco-gpu**: HistoryRepository (Append, Query) + Filter type\n\n4. **Error System (started)**:\n   - **deco-16w**: DecoError tests written (Rust-like error structure)\n\n5. **deco-16e**: Closed Foundation epic (all dependencies complete)\n\n### Project State:\n- All tests passing (domain layer complete)\n- Clean architecture: domain types → repository interfaces → (next: implementations)\n- 18/99 issues closed, 13 ready to work\n- Working tree clean, all pushed to remote\n\n## Next Steps (Recommended Priority):\n\n### Immediate: Complete Error System\nThe error system tests are written (deco-16w ✓), next is implementation:\n1. **deco-03s**: Define DecoError structure (BLOCKED by deco-16w, now ready)\n   - Implement DecoError, Location, Related types\n   - Implement Error() method\n   - Make tests pass\n\nThen continue with error system tasks (all now unblocked):\n2. **deco-8sd/deco-7cp**: Error code registry (tests + impl)\n3. **deco-yu5/deco-e9t**: Error formatter (tests + impl)\n4. **deco-inq**: Error documentation generator\n\n### Then: Storage Implementations\nAfter error system, implement repository interfaces:\n1. **deco-53k/deco-nkw**: YAML NodeRepository (tests + impl)\n2. **deco-344/deco-5ry**: File discovery for nodes (tests + impl)\n3. **deco-77y/deco-px9**: ConfigRepository (tests + impl)\n4. **deco-hxq/deco-owf**: HistoryRepository (tests + impl)\n5. **deco-1jc/deco-nbv**: YAML line number tracking (tests + impl)\n6. **deco-mvn/deco-m9l**: YAML context extraction (tests + impl)\n\n### Architecture Notes:\n- Following strict TDD: tests first, then implementation\n- Error system follows Rust-like pattern (Code, Summary, Detail, Location, Context, Suggestion, Related)\n- Storage layer uses repository pattern for testability\n- All domain types have validation methods\n\n### Working Relationship Reminder:\n- CEO: Strategic decisions, unblocking\n- CTO (Claude): Task selection, execution, git management\n- Staff: Subagents for coding tasks","status":"closed","priority":0,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T14:24:51.3563485+01:00","created_by":"Anton","updated_at":"2026-01-31T14:36:51.1604231+01:00","closed_at":"2026-01-31T14:36:51.1604231+01:00","close_reason":"Closed"}
{"id":"deco-cxk","title":"Decide and implement block schema (inline fields vs data map)","description":"Need a clear canonical block representation to prevent data loss.\n\nDecision to make:\n- Keep inline block fields (text/columns/rows/etc.) as canonical and map them into Block.Data, OR\n- Require explicit `data:` for all blocks and update docs/examples accordingly.\n\nAcceptance:\n- Chosen schema is implemented consistently in load/save.\n- README/examples updated to match the schema.\n- No silent dropping of block fields.","notes":"Decision: Keep inline block fields as canonical. Implement custom YAML unmarshaler for Block to capture all fields (except 'type') into Data map.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T17:32:27.5326203+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:49:57.4572519+01:00","closed_at":"2026-02-01T17:49:57.4572519+01:00","close_reason":"Implemented inline block fields as canonical. Custom YAML marshal/unmarshal for Block captures all fields (except type) into Data map.","dependencies":[{"issue_id":"deco-cxk","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:08:11.3015281+01:00","created_by":"Toernblom"}]}
{"id":"deco-duf","title":"Session handover: mv command and CLI epic complete","notes":"## Session Accomplishments (2026-01-31)\n\n### Completed\n1. **deco-747**: Wrote 17 comprehensive tests for mv command\n   - Structure, rename, ref updates, history, errors, integration\n2. **deco-vzo**: Implemented deco mv command\n   - Renames node ID and file\n   - Updates Uses and Related references across all nodes\n   - Increments version on affected nodes\n   - Records move operation in history\n3. **deco-c5c**: Shell completion - Cobra provides automatically\n4. **deco-7yo**: Closed CLI epic (all commands implemented)\n\n### Project State\n- Tests: All passing\n- Working tree: Clean\n- Pushed to origin/master\n\n### Remaining Work (P4 backlog)\nAll 4 open issues are contract-related:\n- deco-4ci: Implement contract scenario parser (ready)\n- deco-0sk: Add contract syntax validator (blocked)\n- deco-wxh: Validate contract scenarios reference valid nodes (blocked)\n- deco-h2c: Add contract validation to deco validate command (blocked)\n\n### Recommended Next Steps\n1. Close this handover when received\n2. Optional: Start contract feature chain with deco-4ci\n3. Consider if contracts need more spec definition first","status":"closed","priority":0,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T16:14:16.5515515+01:00","created_by":"Anton","updated_at":"2026-01-31T16:15:16.7222771+01:00","closed_at":"2026-01-31T16:15:16.7222771+01:00","close_reason":"Received handover, continuing work"}
{"id":"deco-e4g","title":"Expand issues/TBD system: filters, severity, per-node tracking","description":"Goal: make issues/TBDs actionable at scale.\n\nNeeds:\n- Filters by severity/status/kind/tag/node.\n- Per-node issue listing and rollups.\n- Clear severity semantics (low/med/high/critical).\n\nAcceptance:\n- `deco issues` supports filters and per-node queries.\n- Output supports quiet/json formats.\n- Docs updated.","status":"open","priority":2,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T18:13:10.7108615+01:00","created_by":"Toernblom","updated_at":"2026-02-01T18:13:10.7108615+01:00","dependencies":[{"issue_id":"deco-e4g","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:13:11.0489766+01:00","created_by":"Toernblom"}]}
{"id":"deco-e9t","title":"Implement error formatter","description":"Create internal/errors/formatter.go. Format DecoError in Rust-like style with colors, line numbers, context lines, and suggestions.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:14.042971+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.459752+01:00","closed_at":"2026-01-31T14:30:08.6535194+01:00","dependencies":[{"issue_id":"deco-e9t","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:19:23.8762828+01:00","created_by":"Toernblom"},{"issue_id":"deco-e9t","depends_on_id":"deco-yu5","type":"blocks","created_at":"2026-01-30T15:26:49.7526178+01:00","created_by":"Toernblom"}]}
{"id":"deco-eft","title":"Write tests for constraint Validator","description":"TDD: Write failing tests for constraint evaluation. Test: expression evaluation, cross-node constraints, violation reporting with both locations.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:44.9319516+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4618324+01:00","closed_at":"2026-01-31T15:15:40.6960749+01:00","dependencies":[{"issue_id":"deco-eft","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:28:07.9954083+01:00","created_by":"Toernblom"}]}
{"id":"deco-elv","title":"Storage: Repository implementations","status":"closed","priority":1,"issue_type":"epic","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:14:07.2831947+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4635227+01:00","closed_at":"2026-01-31T14:50:01.4251012+01:00","dependencies":[{"issue_id":"deco-elv","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:17:34.7975048+01:00","created_by":"Toernblom"},{"issue_id":"deco-elv","depends_on_id":"deco-nkw","type":"blocks","created_at":"2026-01-30T15:18:31.3793989+01:00","created_by":"Toernblom"},{"issue_id":"deco-elv","depends_on_id":"deco-5ry","type":"blocks","created_at":"2026-01-30T15:18:31.5980858+01:00","created_by":"Toernblom"},{"issue_id":"deco-elv","depends_on_id":"deco-px9","type":"blocks","created_at":"2026-01-30T15:18:31.8590352+01:00","created_by":"Toernblom"},{"issue_id":"deco-elv","depends_on_id":"deco-owf","type":"blocks","created_at":"2026-01-30T15:18:32.0970858+01:00","created_by":"Toernblom"},{"issue_id":"deco-elv","depends_on_id":"deco-nbv","type":"blocks","created_at":"2026-01-30T15:18:32.3297741+01:00","created_by":"Toernblom"}]}
{"id":"deco-flq","title":"Session handover: CLI commands (validate, list, show)","notes":"## Session Accomplishments (2026-01-31)\n\n### Completed: CLI Commands - Phase 1 (6 issues closed)\n\n**Validate Command (2 issues):**\n1. **deco-sbk**: Write tests for deco validate command\n   - 24 comprehensive test cases\n   - Tests schema, reference, constraint validation\n   - Tests --quiet flag, error output, exit codes\n   \n2. **deco-1fm**: Implement deco validate command\n   - Uses Validator Orchestrator from services\n   - Exit code 0 on valid, 1 on errors\n   - Rust-like error formatting\n   - All 24 tests passing\n\n**List Command (2 issues):**\n3. **deco-wlu**: Write tests for deco list command\n   - 23 comprehensive test cases\n   - Tests --kind, --status, --tag filters\n   - Tests combined filters, table output\n   \n4. **deco-qll**: Implement deco list command\n   - Uses QueryEngine.Filter() from services\n   - Dynamic table formatting\n   - Multiple filter support with AND logic\n   - All 23 tests passing\n\n**Show Command (2 issues):**\n5. **deco-s5c**: Write tests for deco show command\n   - 19 comprehensive test cases\n   - Tests node display, reverse refs, --json output\n   \n6. **deco-4q8**: Implement deco show command\n   - Uses GraphBuilder.BuildReverseIndex() for reverse refs\n   - Human-readable and JSON output modes\n   - Displays all node fields comprehensively\n   - All 19 tests passing\n\n### Project State:\n- **Tests:** All passing (66 new CLI tests + existing)\n  - CLI total: 24 init + 5 root + 24 validate + 23 list + 19 show = 95 tests\n  - All other test suites: passing (cached)\n- **Coverage:** 83/105 issues closed (79%)\n- **Working tree:** Clean, pushed to remote (commit 48bd30c)\n- **Commands:** init, validate, list, show - all working end-to-end\n\n### Architecture Status:\n```\n✅ Domain Layer: Complete\n✅ Error System: Complete\n✅ Storage Layer: Complete\n✅ Service Layer: Complete\n✅ CLI Layer: Core commands complete\n   ✅ Root command: Help, version, global flags\n   ✅ Init command: Project initialization\n   ✅ Validate command: Schema + ref + constraint validation\n   ✅ List command: Filter by kind/status/tag, table output\n   ✅ Show command: Node details + reverse refs + JSON\n   ⏳ Query command: Advanced filtering (next)\n   ⏳ Set/Append/Unset/Apply: Mutation commands\n   ⏳ Mv command: Node rename\n   ⏳ History command: Audit log\n```\n\n## Next Steps: Continue CLI Commands\n\n### Recommended Priority Order:\n\n**1. Query Command (deco-vz6/deco-1eg)** - NEXT PRIORITY\n   - Advanced filtering and search\n   - Use QueryEngine.Filter() + Search()\n   - Combine filters with text search\n   - Issue IDs: deco-vz6 (tests), deco-1eg (impl)\n\n**2. Set Command (deco-0jp/deco-53i)**\n   - Use Patcher.Set() for field updates\n   - Validate before and after\n   - Issue IDs: deco-0jp (tests), deco-53i (impl)\n\n**3. Append Command (deco-zix/deco-1v8)**\n   - Use Patcher.Append() for arrays\n   - Validate after append\n   - Issue IDs: deco-zix (tests), deco-1v8 (impl)\n\n**4. Unset Command (deco-3vb/deco-31k)**\n   - Use Patcher.Unset() to remove fields\n   - Validate after unset\n   - Issue IDs: deco-3vb (tests), deco-31k (impl)\n\n**5. Apply Command (deco-tzg/deco-0kr)**\n   - Use Patcher.Apply() for batch operations\n   - Support JSON patch format\n   - Issue IDs: deco-tzg (tests), deco-0kr (impl)\n\n**6. History Command (deco-7kj/deco-6j1)**\n   - Use HistoryRepository for audit log\n   - Issue IDs: deco-7kj (tests), deco-6j1 (impl)\n\n**7. Mv Command (deco-747/deco-vzo + deco-bhb/deco-142)**\n   - Requires node rename service (deco-142)\n   - Update all references automatically\n   - Issue IDs: deco-747 (tests), deco-vzo (impl), deco-bhb/deco-142 (rename service)\n\n### Ready-to-Work Issues:\n```bash\nbd ready\n```\n\nCurrently 10 issues ready to work (no blockers).\n\n## Implementation Notes:\n\n### CLI Pattern Established:\n1. Write tests first (TDD) - verify they fail\n2. Implement command using services (never direct storage)\n3. Test structure: command structure, happy path, error cases, flags, integration\n4. All commands follow this structure:\n   - Load config to verify project\n   - Load nodes as needed\n   - Use service layer for business logic\n   - Format output appropriately\n   - Return proper exit codes\n\n### Services Available:\n- **QueryEngine**: Filter (kind/status/tags), Search (text)\n- **Patcher**: Set, Append, Unset, Apply (batch with rollback)\n- **GraphBuilder**: Dependencies, cycles, topological sort, reverse index\n- **Validators**: Schema, Reference, Constraint, Orchestrator\n- **ConfigRepository**: Load/save project config\n- **NodeRepository**: Load/save/delete nodes\n- **HistoryRepository**: Audit log queries\n\n### Test Infrastructure:\n- Use t.TempDir() for isolated test directories\n- Create YAML files directly (no repositories in tests)\n- Pass directory argument to commands\n- Test all flags (long and short versions)\n- Test error cases and edge cases\n- Test integration with root command\n\n### Manual Testing Pattern:\n```bash\ngo test ./...                    # All tests\ngo build ./cmd/deco              # Build binary\n./deco init /tmp/test-project    # Create test project\n./deco validate /tmp/test-project\n./deco list /tmp/test-project\n./deco show \u003cid\u003e /tmp/test-project\n```\n\n## Technical Context:\n\n### Recent Commits:\n- bb64751: Implement validate command (24 tests)\n- 0f7a39a: Implement list command (23 tests)\n- 48bd30c: Implement show command (19 tests)\n\n### Session Workflow:\n1. Check `bd ready` for available work\n2. Claim issue with `bd update \u003cid\u003e --status=in_progress`\n3. Write tests first (TDD)\n4. Verify tests fail\n5. Implement to make tests pass\n6. Add command to cmd/deco/main.go\n7. Manual end-to-end testing\n8. Close issue with `bd close \u003cid\u003e`\n9. Stage, commit, sync, push\n\n### Commit Message Format:\n```\nImplement \u003ccommand\u003e command with \u003ckey features\u003e\n\n\u003cdetailed implementation notes\u003e\n- Test file: X test cases covering...\n- Implementation: Uses \u003cservices\u003e...\n- Integration: Wire up in main.go\n\nAll X tests passing. Manual end-to-end testing confirmed.\n\nCloses: \u003cissue-ids\u003e\n\nCo-Authored-By: Claude Sonnet 4.5 \u003cnoreply@anthropic.com\u003e\n```\n\n### Session End Checklist:\n```\n[x] 1. Close finished issues (bd close \u003cid1\u003e \u003cid2\u003e ...)\n[x] 2. Create handover issue (this issue)\n[x] 3. Sync beads (bd sync)\n[x] 4. Stage and commit code (git add \u0026\u0026 git commit)\n[x] 5. Final sync (bd sync)\n[x] 6. Push to remote (git push)\n```\n\n## Query Command Details (Next Task):\n\nThe query command will be similar to list but with text search capability:\n- Combines filtering (kind/status/tag) with text search\n- Uses QueryEngine.Filter() + QueryEngine.Search()\n- Search is case-insensitive, searches title and summary\n- Output in same table format as list\n- All filters are AND logic\n\nExpected flags:\n- --kind, --status, --tag (same as list)\n- --search or -s for text search term\n- Possibly --json for JSON output\n\nImplementation should be straightforward given list and show examples.","status":"closed","priority":0,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T15:46:31.9150801+01:00","created_by":"Anton","updated_at":"2026-01-31T15:49:37.2791878+01:00","closed_at":"2026-01-31T15:49:37.2791878+01:00","close_reason":"Session context recovered"}
{"id":"deco-gp6","title":"Add deco issues command to list all TBDs","description":"Add a 'deco issues' command that lists all open issues/TBDs across the entire design graph. Support filtering by --severity and --node. Show location and context for each issue.","status":"open","priority":3,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T16:32:07.5332441+01:00","created_by":"Anton","updated_at":"2026-01-31T16:32:07.5332441+01:00"}
{"id":"deco-gpu","title":"Define HistoryRepository interface","description":"Create internal/storage/history/repository.go with interface: Append(entry), Query(filter) for append-only audit log.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:21.1895163+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.464705+01:00","closed_at":"2026-01-31T14:20:51.298229+01:00"}
{"id":"deco-gw6","title":"Session handover: Node rename service complete","notes":"## Session Accomplishments (2026-01-31)\n\n### Completed: Node Rename Service (2 issues)\n1. **deco-bhb**: Write tests for node rename - 26 comprehensive tests\n2. **deco-142**: Implement node rename with ref updates\n   - Renames node ID\n   - Updates all Uses and Related references across the graph\n   - Increments version on nodes whose references were updated\n   - Deep copy to avoid modifying original nodes\n   - Full validation (empty IDs, non-existent, collisions)\n\n### In Progress\n- **deco-747**: Write tests for deco mv command (claimed but not started)\n  - Next session should continue this or unclaim if needed\n\n### Project State\n- Tests: All passing (26 new rename tests + existing tests)\n- Working tree: Clean\n- New files: internal/services/refactor/rename.go and rename_test.go\n\n### Recommended Next Steps\n1. Continue deco-747: Write mv command tests\n2. deco-vzo: Implement deco mv command (uses Renamer service)\n3. deco-c5c: Shell completion generation","status":"closed","priority":0,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T16:07:50.0653789+01:00","created_by":"Anton","updated_at":"2026-01-31T16:08:36.5583124+01:00","closed_at":"2026-01-31T16:08:36.5583124+01:00","close_reason":"Handover received, continuing work"}
{"id":"deco-h2c","title":"Add contract validation to deco validate command","description":"Integrate contract validator into deco validate orchestrator. Report errors for invalid contract syntax or references.","status":"open","priority":4,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T14:01:55.8456991+01:00","created_by":"Anton","updated_at":"2026-01-31T14:01:55.8456991+01:00","dependencies":[{"issue_id":"deco-h2c","depends_on_id":"deco-wxh","type":"blocks","created_at":"2026-01-31T14:02:10.057667+01:00","created_by":"Anton"}]}
{"id":"deco-h9q","title":"Write tests for Patcher apply operation","description":"TDD: Write failing tests for patch file application. Test: JSON patch format, multiple operations, rollback on error.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:26:02.1430771+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4666111+01:00","closed_at":"2026-01-31T15:08:23.0834663+01:00","dependencies":[{"issue_id":"deco-h9q","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:28:15.1834563+01:00","created_by":"Toernblom"}]}
{"id":"deco-hsx","title":"Require content for approved/published nodes (allow drafts without content)","description":"As a GDD author, I want strictness to increase with status.\n\nAcceptance:\n- status=draft: content optional.\n- status=approved or published: content (and at least one section) required.\n- Validation error should be clear and actionable.","status":"open","priority":2,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T17:32:34.7994548+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:32:34.7994548+01:00","dependencies":[{"issue_id":"deco-hsx","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:08:11.5642835+01:00","created_by":"Toernblom"}]}
{"id":"deco-hxq","title":"Write tests for HistoryRepository","description":"TDD: Write failing tests for append-only history repository. Test: Append(entry), Query(filter), file creation, append-only guarantee, concurrent writes.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:24.3385811+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4676558+01:00","closed_at":"2026-01-31T14:43:40.5504674+01:00","dependencies":[{"issue_id":"deco-hxq","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:27:59.3043757+01:00","created_by":"Toernblom"}]}
{"id":"deco-im0","title":"Write tests for reverse reference indexing","description":"TDD: Write failing tests for reverse ref computation. Test: used-by index, multiple refs to same node, circular refs, orphan nodes.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:37.9720201+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4696544+01:00","closed_at":"2026-01-31T15:01:31.3955485+01:00","dependencies":[{"issue_id":"deco-im0","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:28:03.6859842+01:00","created_by":"Toernblom"}]}
{"id":"deco-inq","title":"Add error documentation generator","description":"Create cmd/deco/docs.go or script to generate error code documentation from registry. Output markdown for docs site.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:35.8091497+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4708584+01:00","closed_at":"2026-01-31T14:31:08.0139225+01:00","dependencies":[{"issue_id":"deco-inq","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:19:24.6835382+01:00","created_by":"Toernblom"}]}
{"id":"deco-jna","title":"Implement reference Validator","description":"Create internal/service/validator/refs.go. Check all refs resolve to existing nodes, collect broken refs with suggestions.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:01.7646971+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4750559+01:00","closed_at":"2026-01-31T15:18:53.103469+01:00","dependencies":[{"issue_id":"deco-jna","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:19:17.2958253+01:00","created_by":"Toernblom"},{"issue_id":"deco-jna","depends_on_id":"deco-xw8","type":"blocks","created_at":"2026-01-30T15:26:55.6139155+01:00","created_by":"Toernblom"}]}
{"id":"deco-jxy","title":"Write tests for GraphBuilder service","description":"TDD: Write failing tests for graph building. Test: building from node slice, handling empty input, populating node map.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:35.4355576+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4766686+01:00","closed_at":"2026-01-31T15:00:08.0435268+01:00","dependencies":[{"issue_id":"deco-jxy","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:28:02.2442266+01:00","created_by":"Toernblom"}]}
{"id":"deco-jyn","title":"deco set panics on nested paths (pointer deref in patcher)","description":"Repro:\n1) Copy examples\\snake to a scratch dir (or use any project)\n2) Run: deco set systems/core content.sections[0].blocks[0].text \"Test\" \u003cdir\u003e\n\nActual: panic: \"reflect: call of reflect.Value.FieldByName on ptr Value\" with stack in internal/services/patcher/patcher.go.\nExpected: command should succeed or return a structured error, never panic.\nLikely cause: patcher.setValue recurses into pointer fields (Content *Content) without handling Ptr.\nRefs: internal/services/patcher/patcher.go, internal/cli/set.go.","status":"closed","priority":1,"issue_type":"bug","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T17:29:55.859943+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:44:55.3152191+01:00","closed_at":"2026-02-01T17:44:55.3152191+01:00","close_reason":"Fixed pointer dereference in patcher - added handling for *Content and other pointer fields in setValue, getField, and unsetValue methods","dependencies":[{"issue_id":"deco-jyn","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:08:09.787502+01:00","created_by":"Toernblom"}]}
{"id":"deco-k3j","title":"Implement Patcher append operation","description":"Create internal/service/patcher/append.go. Append value to array field at path.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:25.6004792+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4778126+01:00","closed_at":"2026-01-31T15:04:15.387267+01:00","dependencies":[{"issue_id":"deco-k3j","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:19:18.0975105+01:00","created_by":"Toernblom"},{"issue_id":"deco-k3j","depends_on_id":"deco-3co","type":"blocks","created_at":"2026-01-30T15:27:06.8229494+01:00","created_by":"Toernblom"}]}
{"id":"deco-ll2","title":"Write tests for Constraint domain type","description":"TDD: Write failing tests for Constraint struct. Test: expression storage, message, scope definition.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:17.1773264+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.478988+01:00","closed_at":"2026-01-31T14:16:50.6705258+01:00"}
{"id":"deco-lwx","title":"Define Constraint domain type","description":"Create internal/domain/constraint.go for validation constraints. Fields: Expr, Message, Scope.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:14:53.7670735+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4805947+01:00","closed_at":"2026-01-31T14:19:52.5017703+01:00","dependencies":[{"issue_id":"deco-lwx","depends_on_id":"deco-ll2","type":"blocks","created_at":"2026-01-30T15:25:33.8221296+01:00","created_by":"Toernblom"}]}
{"id":"deco-m9l","title":"Implement YAML context extraction","description":"Create internal/errors/context.go. Extract surrounding lines from YAML file for error display. Handle edge cases (start/end of file).","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:20.4081378+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4816024+01:00","closed_at":"2026-01-31T14:49:41.5586651+01:00","dependencies":[{"issue_id":"deco-m9l","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:19:24.0843762+01:00","created_by":"Toernblom"},{"issue_id":"deco-m9l","depends_on_id":"deco-mvn","type":"blocks","created_at":"2026-01-30T15:26:52.9614976+01:00","created_by":"Toernblom"}]}
{"id":"deco-mvn","title":"Write tests for YAML context extraction","description":"TDD: Write failing tests for context extraction. Test: surrounding lines, start of file, end of file, column highlighting.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:26:00.9493778+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4836023+01:00","closed_at":"2026-01-31T14:48:47.6526925+01:00","dependencies":[{"issue_id":"deco-mvn","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:29:05.6223231+01:00","created_by":"Toernblom"}]}
{"id":"deco-nbv","title":"Add YAML line number tracking","description":"Wrap yaml.v3 decoder to track line/column numbers for each parsed field. Essential for error reporting with locations.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:14:56.8654048+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4846023+01:00","closed_at":"2026-01-31T14:47:35.2166661+01:00","dependencies":[{"issue_id":"deco-nbv","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:19:19.0520924+01:00","created_by":"Toernblom"},{"issue_id":"deco-nbv","depends_on_id":"deco-1jc","type":"blocks","created_at":"2026-01-30T15:27:01.7334017+01:00","created_by":"Toernblom"}]}
{"id":"deco-nkw","title":"Implement YAML NodeRepository","description":"Create internal/storage/node/yaml_repository.go implementing NodeRepository. Parse YAML files from .deco/nodes/, handle nested directories, preserve line numbers for error reporting.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:14:37.9654509+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4856023+01:00","closed_at":"2026-01-31T14:33:34.5787752+01:00","dependencies":[{"issue_id":"deco-nkw","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:19:13.0055101+01:00","created_by":"Toernblom"},{"issue_id":"deco-nkw","depends_on_id":"deco-53k","type":"blocks","created_at":"2026-01-30T15:26:47.7104161+01:00","created_by":"Toernblom"}]}
{"id":"deco-nop","title":"Write tests for QueryEngine search","description":"TDD: Write failing tests for text search. Test: search titles, search content, case insensitivity, partial matches.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:26:08.3487284+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4881819+01:00","closed_at":"2026-01-31T15:10:50.2135732+01:00","dependencies":[{"issue_id":"deco-nop","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:28:19.947583+01:00","created_by":"Toernblom"}]}
{"id":"deco-oam","title":"Implement QueryEngine search","description":"Add text search across node titles, content, and issues.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:47.5146457+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4892524+01:00","closed_at":"2026-01-31T15:11:29.9079775+01:00","dependencies":[{"issue_id":"deco-oam","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:19:18.9315899+01:00","created_by":"Toernblom"},{"issue_id":"deco-oam","depends_on_id":"deco-nop","type":"blocks","created_at":"2026-01-30T15:27:14.1430263+01:00","created_by":"Toernblom"}]}
{"id":"deco-ora","title":"Write tests for Node domain type","description":"TDD: Write failing tests for Node struct before implementation. Test: creation, field access, validation of required fields (ID, Kind, Version, Status, Title), serialization/deserialization.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:12.0398927+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4903771+01:00","closed_at":"2026-01-31T14:14:49.4766111+01:00"}
{"id":"deco-owf","title":"Implement HistoryRepository","description":"Create internal/storage/history/jsonl_repository.go implementing HistoryRepository. Append-only JSONL file at .deco/history.jsonl.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:14:52.9524965+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4925127+01:00","closed_at":"2026-01-31T14:44:25.4224599+01:00","dependencies":[{"issue_id":"deco-owf","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:19:17.590436+01:00","created_by":"Toernblom"},{"issue_id":"deco-owf","depends_on_id":"deco-hxq","type":"blocks","created_at":"2026-01-30T15:26:57.4374151+01:00","created_by":"Toernblom"}]}
{"id":"deco-p54","title":"Define NodeRepository interface","description":"Create internal/storage/node/repository.go with interface: LoadAll, Load(id), Save(node), Delete(id), Exists(id).","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:10.9458634+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4935207+01:00","closed_at":"2026-01-31T14:20:51.2929517+01:00"}
{"id":"deco-p75","title":"Backwards-compatible schema migrations","description":"Goal: evolve schema without breaking existing docs.\n\nAcceptance:\n- Versioned schema support and migration path.\n- Clear CLI for migrating a project.","status":"open","priority":2,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T18:13:56.4237215+01:00","created_by":"Toernblom","updated_at":"2026-02-01T18:13:56.4237215+01:00","dependencies":[{"issue_id":"deco-p75","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:13:56.7485745+01:00","created_by":"Toernblom"}]}
{"id":"deco-pqf","title":"Implement reverse reference indexing","description":"In GraphBuilder, compute 'used-by' reverse refs so we can show what references a node.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:14:52.1427107+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4950255+01:00","closed_at":"2026-01-31T15:01:31.423966+01:00","dependencies":[{"issue_id":"deco-pqf","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:19:16.8596446+01:00","created_by":"Toernblom"},{"issue_id":"deco-pqf","depends_on_id":"deco-im0","type":"blocks","created_at":"2026-01-30T15:26:48.7477545+01:00","created_by":"Toernblom"}]}
{"id":"deco-px9","title":"Implement ConfigRepository","description":"Create internal/storage/config/yaml_config.go implementing ConfigRepository. Load/save .deco/config.yaml with project settings.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:14:46.9945942+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4960322+01:00","closed_at":"2026-01-31T14:36:33.0877292+01:00","dependencies":[{"issue_id":"deco-px9","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:19:15.7736107+01:00","created_by":"Toernblom"},{"issue_id":"deco-px9","depends_on_id":"deco-77y","type":"blocks","created_at":"2026-01-30T15:26:53.7317002+01:00","created_by":"Toernblom"}]}
{"id":"deco-q41","title":"Write tests for Patcher unset operation","description":"TDD: Write failing tests for unset operation. Test: remove field, remove nested field, remove from array, missing field handling.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:58.2038273+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4981389+01:00","closed_at":"2026-01-31T15:04:15.3166826+01:00","dependencies":[{"issue_id":"deco-q41","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:28:13.7634956+01:00","created_by":"Toernblom"}]}
{"id":"deco-qll","title":"Implement deco list command","description":"Create internal/cli/list.go. List all nodes with filters: --kind, --status, --tag. Table output format.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:09.8889115+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.4991441+01:00","closed_at":"2026-01-31T15:41:49.0083771+01:00","dependencies":[{"issue_id":"deco-qll","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:19:23.266278+01:00","created_by":"Toernblom"},{"issue_id":"deco-qll","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:19:27.0820424+01:00","created_by":"Toernblom"},{"issue_id":"deco-qll","depends_on_id":"deco-wlu","type":"blocks","created_at":"2026-01-30T15:27:04.1213626+01:00","created_by":"Toernblom"}]}
{"id":"deco-rba","title":"Initialize Go module and project structure","description":"Run go mod init, create folder structure: cmd/deco/, internal/domain/, internal/storage/, internal/service/, internal/cli/. Add .gitignore for Go.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:14:32.9760422+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.5001972+01:00","closed_at":"2026-01-31T14:13:18.9365676+01:00"}
{"id":"deco-rib","title":"Define strict top-level schema with explicit extension mechanism","description":"Goal: Reject unknown top-level keys during validation while still allowing intentional extensions.\n\nProposal:\n- Validation should fail on unknown root keys by default.\n- Provide an explicit escape hatch: e.g. `custom:` map or `x_*` namespace, or a `--allow-unknown` flag.\n- Document the extension mechanism in README/SPEC.\n\nAcceptance:\n- Unknown top-level key fails validation in default mode.\n- Keys under the extension namespace pass.\n- Docs updated to explain how to extend safely.","status":"closed","priority":2,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T17:32:19.5299595+01:00","created_by":"Toernblom","updated_at":"2026-02-01T18:06:51.5063133+01:00","closed_at":"2026-02-01T18:06:51.5063133+01:00","close_reason":"Implemented unknown top-level field detection with E010 error code. Validator now rejects unknown keys and suggests corrections for typos. Extension data goes in 'custom:' namespace.","dependencies":[{"issue_id":"deco-rib","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:08:11.0515069+01:00","created_by":"Toernblom"}]}
{"id":"deco-rmv","title":"Detect and warn on concurrent edit conflicts","description":"Goal: prevent silent overwrites when multiple edits occur.\n\nAcceptance:\n- Detect stale version edits (optimistic concurrency).\n- Clear error with remediation (rebase/merge).\n- Optional override flag.","status":"open","priority":3,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T18:13:12.1612223+01:00","created_by":"Toernblom","updated_at":"2026-02-01T18:13:12.1612223+01:00","dependencies":[{"issue_id":"deco-rmv","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:13:12.4881015+01:00","created_by":"Toernblom"}]}
{"id":"deco-rrk","title":"Define Ref domain type","description":"Create internal/domain/ref.go for node references. Types: uses, related, emits_events, vocabulary. Include RefLink for resolved refs.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:00.2743012+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.5023843+01:00","closed_at":"2026-01-31T14:19:52.5043553+01:00","dependencies":[{"issue_id":"deco-rrk","depends_on_id":"deco-xjv","type":"blocks","created_at":"2026-01-30T15:25:36.7397301+01:00","created_by":"Toernblom"}]}
{"id":"deco-rs0","title":"Review workflow: approvals, status transitions, changelog notes","description":"Goal: formalize draft -\u003e approved/published workflow.\n\nNeeds:\n- Review approvals (at least 1 required) and reviewer metadata.\n- Guarded status transitions with rules.\n- Changelog notes stored with history.\n\nAcceptance:\n- CLI supports approve/reject and status transitions.\n- Validation enforces required approvals for approved/published.\n- History shows review notes.","status":"open","priority":2,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T18:13:11.4446748+01:00","created_by":"Toernblom","updated_at":"2026-02-01T18:13:11.4446748+01:00","dependencies":[{"issue_id":"deco-rs0","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:13:11.7722123+01:00","created_by":"Toernblom"}]}
{"id":"deco-s5c","title":"Write tests for deco show command","description":"TDD: Write failing tests for show command. Test: displays node details, shows reverse refs, handles missing node, --json output.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:26:03.2086064+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.5038891+01:00","closed_at":"2026-01-31T15:43:07.4535134+01:00","dependencies":[{"issue_id":"deco-s5c","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:28:38.0120412+01:00","created_by":"Toernblom"},{"issue_id":"deco-s5c","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:28:39.4605875+01:00","created_by":"Toernblom"}]}
{"id":"deco-sbk","title":"Write tests for deco validate command","description":"TDD: Write failing tests for validate command. Test: exit code 0 on valid, exit code 1 on errors, error output format, --quiet flag.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:54.2300326+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.5048963+01:00","closed_at":"2026-01-31T15:37:21.7536733+01:00","dependencies":[{"issue_id":"deco-sbk","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:28:32.199527+01:00","created_by":"Toernblom"},{"issue_id":"deco-sbk","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:28:33.6599643+01:00","created_by":"Toernblom"}]}
{"id":"deco-shb","title":"Write tests for Graph domain type","description":"TDD: Write failing tests for Graph struct. Test: node storage, lookup by ID, iteration, empty graph handling, duplicate ID handling.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:13.8966573+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.5058969+01:00","closed_at":"2026-01-31T14:15:31.6726611+01:00"}
{"id":"deco-sz1","title":"Write tests for deco init command","description":"TDD: Write failing tests for init command. Test: creates .deco/, creates config.yaml, creates nodes/, detects existing project, --force flag.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:50.869407+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.5078974+01:00","closed_at":"2026-01-31T15:29:53.5490126+01:00","dependencies":[{"issue_id":"deco-sz1","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:28:29.2651094+01:00","created_by":"Toernblom"},{"issue_id":"deco-sz1","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:28:30.7631489+01:00","created_by":"Toernblom"}]}
{"id":"deco-t2h","title":"Add deco diff command to show node history","description":"Add a 'deco diff \u003cid\u003e' command that shows changes to a node over time from the history log. Support --since=\u003ctimestamp\u003e and --last=N to limit output. Show before/after for each change.","status":"open","priority":3,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T16:32:12.5040751+01:00","created_by":"Anton","updated_at":"2026-01-31T16:32:12.5040751+01:00"}
{"id":"deco-t5h","title":"Add deco rm command to delete nodes","description":"Add a 'deco rm \u003cid\u003e' command to delete a node. Should warn if other nodes reference it (show reverse refs) and require --force to delete anyway. Log deletion in history.","status":"open","priority":3,"issue_type":"feature","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T16:32:05.8956527+01:00","created_by":"Anton","updated_at":"2026-01-31T16:32:05.8956527+01:00"}
{"id":"deco-t6q","title":"Services: Business logic layer","notes":"Core services complete: GraphBuilder, Patcher (set/append/unset/apply), QueryEngine (filter/search), Validators (schema/reference/constraint/orchestrator). Node rename (deco-142) deferred to Phase 4 as advanced CLI feature. Service layer is ready for CLI implementation.","status":"closed","priority":1,"issue_type":"epic","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:14:08.8607203+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.5094712+01:00","closed_at":"2026-01-31T15:29:49.2219778+01:00","dependencies":[{"issue_id":"deco-t6q","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:17:34.9972665+01:00","created_by":"Toernblom"},{"issue_id":"deco-t6q","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:17:36.8649569+01:00","created_by":"Toernblom"},{"issue_id":"deco-t6q","depends_on_id":"deco-0o3","type":"blocks","created_at":"2026-01-30T15:18:45.4580692+01:00","created_by":"Toernblom"},{"issue_id":"deco-t6q","depends_on_id":"deco-pqf","type":"blocks","created_at":"2026-01-30T15:18:45.6529006+01:00","created_by":"Toernblom"},{"issue_id":"deco-t6q","depends_on_id":"deco-bx5","type":"blocks","created_at":"2026-01-30T15:18:45.8532475+01:00","created_by":"Toernblom"},{"issue_id":"deco-t6q","depends_on_id":"deco-jna","type":"blocks","created_at":"2026-01-30T15:18:46.0426428+01:00","created_by":"Toernblom"},{"issue_id":"deco-t6q","depends_on_id":"deco-9ls","type":"blocks","created_at":"2026-01-30T15:18:46.232879+01:00","created_by":"Toernblom"},{"issue_id":"deco-t6q","depends_on_id":"deco-2y3","type":"blocks","created_at":"2026-01-30T15:18:46.4245689+01:00","created_by":"Toernblom"},{"issue_id":"deco-t6q","depends_on_id":"deco-7rp","type":"blocks","created_at":"2026-01-30T15:18:46.6158991+01:00","created_by":"Toernblom"},{"issue_id":"deco-t6q","depends_on_id":"deco-k3j","type":"blocks","created_at":"2026-01-30T15:18:46.8059952+01:00","created_by":"Toernblom"},{"issue_id":"deco-t6q","depends_on_id":"deco-750","type":"blocks","created_at":"2026-01-30T15:18:46.9999896+01:00","created_by":"Toernblom"},{"issue_id":"deco-t6q","depends_on_id":"deco-7yp","type":"blocks","created_at":"2026-01-30T15:18:47.1872022+01:00","created_by":"Toernblom"},{"issue_id":"deco-t6q","depends_on_id":"deco-0s1","type":"blocks","created_at":"2026-01-30T15:18:47.3789916+01:00","created_by":"Toernblom"},{"issue_id":"deco-t6q","depends_on_id":"deco-oam","type":"blocks","created_at":"2026-01-30T15:18:47.5743156+01:00","created_by":"Toernblom"},{"issue_id":"deco-t6q","depends_on_id":"deco-142","type":"blocks","created_at":"2026-01-30T15:18:47.7621404+01:00","created_by":"Toernblom"}]}
{"id":"deco-tw3","title":"Session handover: Service layer progress - 54% complete","notes":"## Session Accomplishments (2026-01-31)\n\n### Completed Issues (14 total, bringing total to 55/102 - 53.9%):\n\n**Error System Complete:**\n1. **deco-5wv/deco-5fv**: Error aggregation (tests + implementation)\n   - Collector for aggregating multiple DecoErrors\n   - Sorts by file, line, column; errors without location come last\n   - Deduplicates by code + location (file:line:column)\n   - Max error limit with truncation tracking\n   - Methods: Add, AddBatch, Errors, HasErrors, Count, Truncated, Reset\n   - 17 comprehensive tests, all passing\n\n2. **deco-5xa**: Error system epic CLOSED\n   - All error system work complete\n   - Core error structure, codes, formatter, docs\n   - YAML integration (location tracking, context extraction)\n   - Suggestion engine (Levenshtein distance)\n   - Error aggregation\n\n**Graph Services Complete:**\n3. **deco-jxy/deco-0o3**: GraphBuilder service (tests + implementation)\n   - Build Graph from Node slices with duplicate detection\n   - BuildDependencyMap: extract Refs.Uses relationships\n   - DetectCycle: find circular dependencies with path\n   - TopologicalSort: dependency-ordered node processing\n   - 16 comprehensive tests, all passing\n\n4. **deco-im0/deco-pqf**: Reverse reference indexing (tests + implementation)\n   - BuildReverseIndex: \"who references this node\" lookup\n   - Includes both Uses and Related references\n   - Deduplicates multiple ref types to same target\n   - Only tracks refs to existing nodes (no dangling refs)\n   - 10 comprehensive tests, all passing\n\n**Patcher Service Complete:**\n5. **deco-aoo/deco-7rp**: Patcher set operation (tests + implementation)\n6. **deco-3co/deco-k3j**: Patcher append operation (tests + implementation)\n7. **deco-q41/deco-750**: Patcher unset operation (tests + implementation)\n   - Unified Patcher service in internal/services/patcher/\n   - Set: modify field values with path notation and type conversion\n   - Append: add values to arrays (handles nil, empty, existing arrays)\n   - Unset: remove fields or array elements (protects required fields)\n   - Path support: dot notation (summary), array indexing (tags[0])\n   - Reflection-based with proper type handling\n   - 18 comprehensive tests, all passing\n\n### Project State:\n- **Tests:** All passing (93 total tests across all packages)\n- **Coverage:** 55/102 issues closed (53.9%)\n- **Working tree:** Clean, pushed to remote\n- **New packages:**\n  - internal/errors/collector.go\n  - internal/services/graph/ (builder.go + tests)\n  - internal/services/patcher/ (patcher.go + tests)\n\n### Architecture Progress:\n```\n✅ Domain Layer: Complete (Node, Graph, Issue, Constraint, Ref, AuditEntry, DecoError)\n✅ Error System: Complete (structure, codes, formatter, docs, YAML, suggestions, aggregation)\n✅ Storage Layer: Complete (NodeRepository, ConfigRepository, HistoryRepository)\n⏳ Service Layer: In Progress (3 of ~7 services complete)\n   ✅ GraphBuilder: Build, dependencies, cycle detection, topological sort, reverse index\n   ✅ Patcher: Set, append, unset operations\n   ⏳ Remaining services needed:\n      - QueryEngine (filter, search)\n      - Validator orchestrator (schema, reference, constraint validation)\n      - (Apply operation for Patcher - batch operations)\n⏳ CLI Layer: Not started (depends on services)\n```\n\n## Next Steps (Recommended Priority):\n\n### Immediate: Complete Remaining Service Layer\n\n1. **Patcher Apply Operation** (deco-h9q/deco-7yp)\n   - Apply batch patch operations from JSON/YAML\n   - For AI integration (patch mode)\n   - Should use existing Set/Append/Unset operations\n\n2. **QueryEngine** (deco-3jm/deco-nop + deco-oam/deco-1eg)\n   - Filter nodes by criteria (kind, status, tags, etc.)\n   - Search by text (title, summary, content)\n   - Tag-based queries\n   - Integration with Graph for efficient lookups\n\n3. **Validator Services** (deco-2t4/deco-az1 + implementations)\n   - Schema validator: check required fields, types\n   - Reference validator: verify all refs resolve\n   - Constraint validator: CEL expression evaluation\n   - Validator orchestrator: coordinate all validators, collect errors\n\n### Then: CLI Layer\nAfter all services are complete, the CLI commands can be implemented:\n\n4. **Core Commands** (in dependency order):\n   - deco init (initialize project)\n   - deco validate (schema + refs + constraints)\n   - deco list (list nodes)\n   - deco show \u003cid\u003e (show node + reverse refs)\n   - deco query \u003cfilter\u003e (search/filter)\n   \n5. **Mutation Commands** (use Patcher):\n   - deco set \u003cid\u003e \u003cpath\u003e \u003cvalue\u003e\n   - deco append \u003cid\u003e \u003cpath\u003e \u003cvalue\u003e\n   - deco unset \u003cid\u003e \u003cpath\u003e\n   - deco apply \u003cpatch-file\u003e\n\n6. **Advanced Commands**:\n   - deco mv \u003cold-id\u003e \u003cnew-id\u003e (with ref updates)\n   - deco history [\u003cid\u003e] (audit log)\n\n## Technical Notes:\n\n### Patcher Design:\n- Reflection-based field access via capitalizeFirst() helper\n- Path parsing: splits by \".\", extracts array indices from \"field[N]\"\n- Array index notation: \"tags[0]\" -\u003e field \"Tags\", index 0\n- Map access: \"glossary.term1\" for nested map keys\n- Type conversion: automatic when types are convertible\n- Required fields: id, kind, version, status, title (cannot unset)\n\n### GraphBuilder Design:\n- Dependency map: nodeID -\u003e []string (list of dependency IDs)\n- Only Refs.Uses creates dependencies (Related does not)\n- Cycle detection: DFS with visiting/visited state tracking\n- Topological sort: Kahn's algorithm with in-degree counting\n- Reverse index: targetID -\u003e []string (nodes that reference target)\n\n### Error Collector Design:\n- Deduplication key: code + file + line + column\n- Sort order: file (alpha), line (numeric), column (numeric)\n- Nil locations come last in sort order\n- Count tracks unique errors, not total attempts to add\n\n### Testing Approach:\n- Strict TDD: all tests written before implementation\n- Comprehensive edge cases: empty, nil, invalid, boundaries\n- Clear test names: TestComponent_Behavior pattern\n- All 93 tests passing\n\n## Ready to Work:\nRun `bd ready` to see available tasks. Recommended next session:\n1. Complete Patcher apply operation\n2. Implement QueryEngine (filter + search)\n3. Implement Validators (schema, reference, constraint, orchestrator)\n\nThis will complete the service layer and unblock all CLI commands.","status":"closed","priority":0,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T15:05:37.9156756+01:00","created_by":"Anton","updated_at":"2026-01-31T15:19:44.905777+01:00","closed_at":"2026-01-31T15:19:44.905777+01:00","close_reason":"Closed"}
{"id":"deco-tzg","title":"Write tests for deco apply command","description":"TDD: Write failing tests for apply command. Test: applies patch file, validates after apply, --dry-run flag, error handling.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:26:20.6528209+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.5110694+01:00","closed_at":"2026-01-31T15:57:49.2433984+01:00","dependencies":[{"issue_id":"deco-tzg","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:28:58.4769979+01:00","created_by":"Toernblom"},{"issue_id":"deco-tzg","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:28:59.9117828+01:00","created_by":"Toernblom"}]}
{"id":"deco-vz6","title":"Write tests for deco query command","description":"TDD: Write failing tests for query command. Test: filter expressions, text search, combined filters, output formats.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:26:07.2480018+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.5126847+01:00","closed_at":"2026-01-31T15:51:06.8776339+01:00","dependencies":[{"issue_id":"deco-vz6","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:28:40.8971074+01:00","created_by":"Toernblom"},{"issue_id":"deco-vz6","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:28:42.3413738+01:00","created_by":"Toernblom"}]}
{"id":"deco-vzo","title":"Implement deco mv command","description":"Create internal/cli/mv.go. Rename node with automatic ref updates across all nodes.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:15:43.3293723+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.5137536+01:00","closed_at":"2026-01-31T16:11:54.674485+01:00","dependencies":[{"issue_id":"deco-vzo","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:19:24.5095363+01:00","created_by":"Toernblom"},{"issue_id":"deco-vzo","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:19:28.2235527+01:00","created_by":"Toernblom"},{"issue_id":"deco-vzo","depends_on_id":"deco-747","type":"blocks","created_at":"2026-01-30T15:27:14.9703002+01:00","created_by":"Toernblom"}]}
{"id":"deco-wlu","title":"Write tests for deco list command","description":"TDD: Write failing tests for list command. Test: lists all nodes, --kind filter, --status filter, --tag filter, table output format.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:59.8866349+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.5148296+01:00","closed_at":"2026-01-31T15:40:08.4801814+01:00","dependencies":[{"issue_id":"deco-wlu","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:28:35.096517+01:00","created_by":"Toernblom"},{"issue_id":"deco-wlu","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:28:36.5646253+01:00","created_by":"Toernblom"}]}
{"id":"deco-wxe","title":"Session handover: Service layer complete - 67% done","notes":"## Session Accomplishments (2026-01-31)\n\n### Completed: Service Layer (18 issues closed)\n\n**Patcher Service Complete (2 issues):**\n1. **deco-h9q/deco-7yp**: Patcher Apply operation\n   - Batch patch operations with transactional rollback\n   - Supports set/append/unset in single atomic operation\n   - Snapshot/restore using gob encoding for rollback\n   - 12 comprehensive tests for apply, all passing\n\n**QueryEngine Service Complete (4 issues):**\n2. **deco-3jm/deco-0s1**: QueryEngine Filter\n   - Filter by kind, status, tags (AND logic)\n   - Combined criteria support\n   - 10 comprehensive tests, all passing\n\n3. **deco-nop/deco-oam**: QueryEngine Search  \n   - Case-insensitive partial text search\n   - Searches title and summary fields\n   - 8 comprehensive tests, all passing\n\n**Validator Services Complete (12 issues):**\n4. **deco-2t4/deco-bx5**: SchemaValidator\n   - Validates required fields (ID, Kind, Version, Status, Title)\n   - Unique error summaries for deduplication\n   - 8 comprehensive tests, all passing\n\n5. **deco-xw8/deco-jna**: ReferenceValidator\n   - Validates Uses and Related references resolve\n   - Generates suggestions for typos using Levenshtein distance\n   - 7 comprehensive tests, all passing\n\n6. **deco-eft/deco-9ls**: ConstraintValidator\n   - CEL (Common Expression Language) evaluation\n   - Supports node field access in constraints\n   - 5 comprehensive tests, all passing\n   - Added google/cel-go v0.27.0 dependency\n\n7. **deco-az1/deco-2y3**: Validator Orchestrator\n   - Coordinates all three validators\n   - Aggregates errors using Collector\n   - Runs validators in order: schema → references → constraints\n   - 5 comprehensive tests, all passing\n\n### Project State:\n- **Tests:** All passing (139 total tests)\n  - Domain: 30 tests\n  - Errors: 21 tests + 17 collector tests = 38 tests\n  - Services:\n    - Graph: 26 tests\n    - Patcher: 30 tests\n    - Query: 18 tests\n    - Validator: 28 tests\n  - Storage: 7 + 3 + 11 = 21 tests\n\n- **Coverage:** 69/103 issues closed (67%)\n- **Working tree:** Clean, pushed to remote (commit be200c6)\n\n### Architecture Complete:\n```\n✅ Domain Layer: Complete (Node, Graph, Issue, Constraint, Ref, AuditEntry, DecoError)\n✅ Error System: Complete (structure, codes, formatter, docs, YAML, suggestions, aggregation)\n✅ Storage Layer: Complete (NodeRepository, ConfigRepository, HistoryRepository)\n✅ Service Layer: COMPLETE\n   ✅ GraphBuilder: Build, dependencies, cycle detection, topological sort, reverse index\n   ✅ Patcher: Set, append, unset, apply (batch with rollback)\n   ✅ QueryEngine: Filter (kind/status/tags), Search (text)\n   ✅ Validators: Schema, Reference, Constraint (CEL), Orchestrator\n⏳ CLI Layer: Not started (all dependencies complete!)\n```\n\n## Next Steps: CLI Implementation\n\nThe service layer is now **100% complete**. All business logic is implemented and tested. The next phase is CLI command implementation using Cobra.\n\n### Recommended Priority Order:\n\n**Phase 1: Core Read Commands (Foundation)**\n1. **deco init** (deco-sz1/deco-7ba)\n   - Initialize project structure\n   - Create .deco/ directory\n   - Unblocks: deco validate\n\n2. **deco validate** (deco-sbk/deco-1fm)\n   - Use Validator Orchestrator\n   - Report schema + reference + constraint errors\n   - Unblocks: all mutation commands (validation first)\n\n3. **deco list** (deco-wlu/deco-qll)\n   - Use QueryEngine for filtering\n   - List nodes by kind/status/tags\n   - Unblocks: workflow commands\n\n4. **deco show \u003cid\u003e** (deco-s5c/deco-4q8)\n   - Display node details\n   - Use GraphBuilder for reverse references\n   - Unblocks: none (standalone)\n\n**Phase 2: Query Commands**\n5. **deco query** (deco-vz6/deco-1eg)\n   - Use QueryEngine filter + search\n   - Advanced filtering and search\n   - Unblocks: none\n\n**Phase 3: Mutation Commands (Use Patcher)**\n6. **deco set \u003cid\u003e \u003cpath\u003e \u003cvalue\u003e** (deco-0jp/deco-53i)\n   - Use Patcher.Set()\n   - Validate before/after\n   - Unblocks: none\n\n7. **deco append \u003cid\u003e \u003cpath\u003e \u003cvalue\u003e** (deco-zix/deco-1v8)\n   - Use Patcher.Append()\n   - Unblocks: none\n\n8. **deco unset \u003cid\u003e \u003cpath\u003e** (deco-3vb/deco-31k)\n   - Use Patcher.Unset()\n   - Unblocks: none\n\n9. **deco apply \u003cpatch-file\u003e** (deco-tzg/deco-0kr)\n   - Use Patcher.Apply() for batch operations\n   - Perfect for AI integration\n   - Unblocks: none\n\n**Phase 4: Advanced Commands**\n10. **deco mv \u003cold\u003e \u003cnew\u003e** (deco-747/deco-vzo + deco-bhb/deco-142)\n    - Rename node with reference updates\n    - Use ReferenceValidator to find refs\n    - Use Patcher for updates\n    - Complex but service layer ready\n\n11. **deco history [\u003cid\u003e]** (deco-7kj/deco-6j1)\n    - Use HistoryRepository\n    - Display audit log\n    - Unblocks: none\n\n### Implementation Notes:\n\n**Cobra Setup:**\n- Root command (deco-336/deco-7au) - basic CLI structure\n- Add shell completion (deco-c5c) - nice to have\n\n**Testing Strategy:**\n- Each command has test + implementation issue\n- Test with real YAML files\n- Validate end-to-end workflows\n- Integration tests for command chains\n\n**Service Integration:**\n- All services are ready and tested\n- NodeRepository for loading/saving\n- ConfigRepository for project settings\n- Validators for pre/post mutation checks\n- QueryEngine for filtering/searching\n- Patcher for all mutations\n- GraphBuilder for dependency analysis\n\n### Dependencies Ready:\nAll CLI commands can now be implemented as thin wrappers around services:\n- ✅ Storage layer handles persistence\n- ✅ QueryEngine handles filtering/searching\n- ✅ Patcher handles mutations\n- ✅ Validators handle validation\n- ✅ GraphBuilder handles dependencies\n- ✅ Error system handles reporting\n\n### CLI Epic:\nThe CLI epic (deco-7yo) tracks overall CLI progress. Currently 0/21 CLI commands implemented. Start with init + validate to establish foundation.\n\n## Technical Context:\n\n### Key Design Decisions:\n1. **Transactional Patcher**: Uses gob encoding for deep copy/restore\n2. **CEL Integration**: google/cel-go for constraint expressions\n3. **Error Deduplication**: Code + Summary for errors without location\n4. **Validator Order**: Schema → References → Constraints (fail fast)\n\n### Code Quality:\n- Strict TDD: All tests written before implementation\n- Comprehensive edge cases: nil, empty, invalid, boundaries\n- All 139 tests passing\n- Clear separation of concerns","status":"closed","priority":0,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T15:20:25.4736031+01:00","created_by":"Anton","updated_at":"2026-01-31T15:30:41.920111+01:00","closed_at":"2026-01-31T15:30:41.920111+01:00","close_reason":"Closed"}
{"id":"deco-wxh","title":"Validate contract scenarios reference valid nodes","description":"Ensure contract scenarios only reference nodes/fields that exist in the design graph. Validate expect_event references to actual event definitions.","status":"open","priority":4,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-31T14:01:55.2152087+01:00","created_by":"Anton","updated_at":"2026-01-31T14:01:55.2152087+01:00","dependencies":[{"issue_id":"deco-wxh","depends_on_id":"deco-0sk","type":"blocks","created_at":"2026-01-31T14:02:09.9248246+01:00","created_by":"Anton"}]}
{"id":"deco-xdp","title":"Validation performance on large projects","description":"Goal: validation scales to large graphs.\n\nAcceptance:\n- Benchmark suite added.\n- Identify/resolve hot spots.","status":"open","priority":3,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-02-01T18:13:19.3200956+01:00","created_by":"Toernblom","updated_at":"2026-02-01T18:13:19.3200956+01:00","dependencies":[{"issue_id":"deco-xdp","depends_on_id":"deco-6iv","type":"blocks","created_at":"2026-02-01T18:13:19.6460174+01:00","created_by":"Toernblom"}]}
{"id":"deco-xjv","title":"Write tests for Ref domain type","description":"TDD: Write failing tests for Ref and RefLink types. Test: ref types (uses, related, emits_events, vocabulary), resolution state.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:19.6034771+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.5164321+01:00","closed_at":"2026-01-31T14:17:39.3264371+01:00"}
{"id":"deco-xw8","title":"Write tests for reference Validator","description":"TDD: Write failing tests for ref validation. Test: valid refs resolve, broken refs detected, suggestion generation for typos.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:42.8887033+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.5175219+01:00","closed_at":"2026-01-31T15:15:40.6600298+01:00","dependencies":[{"issue_id":"deco-xw8","depends_on_id":"deco-elv","type":"blocks","created_at":"2026-01-30T15:28:06.5415689+01:00","created_by":"Toernblom"}]}
{"id":"deco-yu5","title":"Write tests for error formatter","description":"TDD: Write failing tests for Rust-like error formatting. Test: line numbers, context lines, color output, suggestion display, related locations.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:25:56.580741+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.5185755+01:00","closed_at":"2026-01-31T14:29:22.8531586+01:00","dependencies":[{"issue_id":"deco-yu5","depends_on_id":"deco-16e","type":"blocks","created_at":"2026-01-30T15:29:04.1886553+01:00","created_by":"Toernblom"}]}
{"id":"deco-zix","title":"Write tests for deco append command","description":"TDD: Write failing tests for append command. Test: appends to array, validates after append, error on non-array.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:26:12.3371003+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.5196295+01:00","closed_at":"2026-01-31T15:54:45.8873016+01:00","dependencies":[{"issue_id":"deco-zix","depends_on_id":"deco-t6q","type":"blocks","created_at":"2026-01-30T15:28:46.7009781+01:00","created_by":"Toernblom"},{"issue_id":"deco-zix","depends_on_id":"deco-5xa","type":"blocks","created_at":"2026-01-30T15:28:48.1986371+01:00","created_by":"Toernblom"}]}
{"id":"deco-zty","title":"Define Graph domain type","description":"Create internal/domain/graph.go with Graph struct holding nodes map and reverse reference index. Methods for node lookup and traversal.","status":"closed","priority":2,"issue_type":"task","owner":"tornblomanton@gmail.com","created_at":"2026-01-30T15:14:43.6047933+01:00","created_by":"Toernblom","updated_at":"2026-02-01T17:09:12.5206682+01:00","closed_at":"2026-01-31T14:19:52.496569+01:00","dependencies":[{"issue_id":"deco-zty","depends_on_id":"deco-shb","type":"blocks","created_at":"2026-01-30T15:25:29.5662991+01:00","created_by":"Toernblom"}]}
